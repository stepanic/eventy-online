{"version":3,"sources":["scripts/app-aa16a6ca7a.js"],"names":["angular","module","constant","backendUrl","enableLogging","RecordController","$scope","$state","$stateParams","$log","$timeout","$mdDialog","$window","WallService","UploadService","deviceDetector","cfpLoadingBar","localStorageService","validator","eachSeries","$q","applyProgress","value","$apply","progressCounter","set","download","file","os","reader","FileReader","onload","e","errorHandler","msg","code","FileError","QUOTA_EXCEEDED_ERR","NOT_FOUND_ERR","SECURITY_ERR","INVALID_MODIFICATION_ERR","INVALID_STATE_ERR","console","log","onInitFs","fs","f","root","getFile","name","create","exclusive","fileEntry","createWriter","fileWriter","write","info","target","result","startsWith","data","filename","element","document","createElement","setAttribute","window","webkitStorageInfo","requestQuota","PERSISTENT","grantedBytes","requestFileSystem","body","removeChild","readAsDataURL","vm","this","wallMasterKey","masterKey","location","showProgressBar","wall","current","go","HandleFiles","files","asyncFilesUploadHandler","deferred","defer","separatedFiles","currentFileIndex","error","type","resolve","event","offset","length","progress","loaded","total","absoluteProgress","promise","start","filesInArray","forEach","push","then","setTimeout","complete","goToProfile","EditProfile","GoToWall","GoToHomepage","confirm","GoToGallery","googleDriveFolderId","googlePhotosAlbumShareId","prefixGoogleDrive","prefixGooglePhotos","galleryUrl","open","$inject","controller","directive","$parse","restrict","link","scope","attrs","model","fileModel","modelSetter","assign","bind","WallVerifiedController","$rootScope","$interval","$sce","$sails","setNewMedia","isRandomAllowed","isActiveMainImage","url","orientation","trustedUrl","trustAsResourceUrl","controls","unshift","mainFile","slice","updateUI","showRandomMedia","first","shift","windowInnerHeight","innerHeight","windowInnerWidth","innerWidth","firstImageWidth","updateCachedMedia","updatedCachedMedia","cachedMedia","get","flags","enableMainFileAnimation","wallMode","slideshow","copy","id","password","image","roomName","crosstab","on","message","supported","isConnected","post","resp","approvedFile","w","changeMainFile","key","old","ToggleWallMode","GoToRecord","isVisibleWallVerifyOption","GoToWallVerify","href","absolute","removeFile","index","indexOf","jQuery","trigger","which","splice","indexInCache","i","handleFile","WallController","ExifService","getOrientation","checked","verifyFile","wallPassword","isVerifyPage","$on","removeAllListeners","thisChangedTimeout","cancel","existingFile","disapprovedFile","unverifyFile","broadcast","approveFile","disapproveFile","priority","attr","$observe","muted","imageUrl","callback","xhr","XMLHttpRequest","responseType","arrayBuffer","Uint8Array","response","exifData","EXIF","readFromBinaryFile","buffer","parseInt","Orientation","send","service","ProfileController","email","displayName","saveProfileAndReturnToRecord","isValidEmail","invalidEmail","InfoController","HomeController","passwordIsFocused","pin","pinIsFocused","failedPinTry","SetValidPin","wrongPin","auth","wrongPassword","toLowerCase","hasPin","activeTab","OpenTab","tabId","$watch","focusMe","val","isDefined","focus","EMAIL_REGEXP","test","stringHelpers","transliterateCyrillicToLatin","word","answer","a","hasOwnProperty","undefined","replaceDiacritics","str","defaultDiacriticsRemovalMap","base","letters","replace","replaceSpacesWithUnderscores","keepOnlyAlfanumericsDotsMonkeysUnderscoresAndDashes","unicodeToAscii","toSafeUriString","input","part","out","urlParts","split","filenameParts","match","filter","ENV","$http","requestUrl","serverBase","fd","FormData","append","transformRequest","identity","headers","Content-Type","success","approveFileApi","disapprove","params","status","summary","getFilePrefix","prefix","currentEmail","currentDisplayName","uploadFiles","uploadProgress","uploadUrl","upload","addEventListener","readyState","JSON","parse","runBlock","pathname","debug","run","routerConfig","$stateProvider","$urlRouterProvider","state","templateUrl","controllerAs","otherwise","config","$logProvider","$locationProvider","localStorageServiceProvider","cfpLoadingBarProvider","debugEnabled","html5Mode","hashPrefix","setPrefix","autoIncrement","$sailsProvider","logExProvider","$templateCache","put"],"mappings":"AAAAA,QAAQC,OAAO,oBAEdC,SAAS,OACTC,WAAc,iCACdC,eAAiB,IAIlB,WACE,YAEAJ,SACGC,OAAO,aACJ,gBACA,oBACA,YACA,YACA,UACA,aACA,aACA,SACA,YACA,aACA,sBACA,qBACA,UACA,YACA,oBACA,wBAIA,iBACA,mCAKR,WACE,YAOA,SAASI,GAAiBC,EAAQC,EAAQC,EAAcC,EAAMC,EAAUC,EAAWC,EAASC,EAAaC,EAAeC,EAAgBC,EAAeC,EAAqBC,EAAWC,EAAYC,GAiCjM,QAASC,GAAcC,GACrBhB,EAAOiB,OAAO,WACZjB,EAAOkB,gBAA0B,IAARF,IAE3BN,EAAcS,IAAIH,GA4IpB,QAASI,GAASC,GAIhB,GAA0B,QAAtBZ,EAAea,IAAsC,YAAtBb,EAAea,GAAkB,CAClE,GAAIC,GAAS,GAAIC,WAEjBD,GAAOE,OAAS,SAAUC,GAsBxB,QAASC,GAAaD,GACpB,GAAIE,GAAM,EAEV,QAAQF,EAAEG,MACR,IAAKC,WAAUC,mBACbH,EAAM,oBACN,MACF,KAAKE,WAAUE,cACbJ,EAAM,eACN,MACF,KAAKE,WAAUG,aACbL,EAAM,cACN,MACF,KAAKE,WAAUI,yBACbN,EAAM,0BACN,MACF,KAAKE,WAAUK,kBACbP,EAAM,mBACN,MACF,SACEA,EAAM,gBAIVQ,QAAQC,IAAI,UAAYT,GAG1B,QAASU,GAASC,IAId,SAAUC,GACRD,EAAGE,KAAKC,QAAQF,EAAEG,MAAOC,QAAQ,EAAMC,WAAW,GAAO,SAASC,GAChEA,EAAUC,aAAa,SAASC,GAC9BA,EAAWC,MAAMT,IAChBb,IACFA,IACFN,GAtDP,GAJAlB,EAAK+C,KAAKxB,GAIgB,QAAtBjB,EAAea,IACZI,EAAEyB,OAAOC,OAAOC,WAAW,eADlC,CASA,GAAIC,GAAO5B,EAAEyB,OAAOC,OAChBG,EAAWlC,EAAKsB,KAEhBa,EAAUC,SAASC,cAAc,IACrCF,GAAQG,aAAa,OAAQL,GAC7BE,EAAQG,aAAa,WAAYJ,GA8CjCK,OAAOC,kBAAkBC,aAAaC,WAAY,QAAa,SAASC,GACtEJ,OAAOK,kBAAkBF,WAAYC,EAAc1B,EAAUX,IAC5D,SAASD,GACVU,QAAQC,IAAI,QAASX,KASvB+B,SAASS,KAAKC,YAAYX,KAG5BjC,EAAO6C,cAAc/C,IAvQzB,GAAIgD,GAAKC,IAETnE,GAAK+C,KAAK,iBAAkBzC,EAE5B,IAAI8D,GAAgBrE,EAAasE,SAE5BD,KAGuB,QAAtB9D,EAAea,IAAsC,YAAtBb,EAAea,IAA0C,kBAAtBb,EAAea,MACnFsC,OAAOa,SAAW,YAItBzE,EAAO0E,iBAAkB,CAUzB1E,GAAOkB,gBAAkB,EAEzBlB,EAAO2E,KAAOpE,EAAYqE,UAErB5E,EAAO2E,MACV1E,EAAO4E,GAAG,QAeZ7E,EAAO8E,YAAc,SAAUC,GA8B7B,QAASC,GAAyB3D,GAChC,GAAI4D,GAAWnE,EAAGoE,QAIdC,GAAkB9D,EA4CtB,OAzCA+D,IAAoB,EAEpB5E,EAAcuE,MAAMI,EAAgB,SAAUE,EAAO/B,GACnDnD,EAAK+C,KAAK,qBAAsBkC,EAAkBD,EAAgB7B,IAExC,QAAtB7C,EAAea,IAAsC,YAAtBb,EAAea,IAA0C,kBAAtBb,EAAea,KAC/EgC,GAAQA,EAAKyB,OAASzB,EAAKyB,MAAM,IAAMzB,EAAKyB,MAAM,GAAGO,KAAKjC,WAAW,UAK3E4B,EAASM,UAQLR,GAASA,EAAM,IAGjB3D,EAAS2D,EAAM,KAEhB,SAAwBS,GAIzB,GAAIC,GAASL,EAAmBL,EAAMW,OAGlCC,EAAWH,EAAMI,OAASJ,EAAMK,MAAQd,EAAMW,OAG9CI,EAAmBL,EAASE,CAEhC5E,GAAc+E,IAEbvB,GAGIU,EAASc,QA7ElB/F,EAAO0E,iBAAkB,EAEzBhE,EAAcsF,QACdtF,EAAcS,IAAI,GAClBnB,EAAOkB,gBAAkB,CAEzB,IAAI+E,KACJvG,SAAQwG,QAAQnB,EAAO,SAAS1D,GAC9B4E,EAAaE,KAAM9E,IAGrB,IAAI+D,GAAmB,EAGvBvE,GAAWoF,EAAcjB,GAAyBoB,KAAK,WAErDjG,EAAK+C,KAAK,0BAGVmD,WAAW,WACTtF,EAAc,GACdf,EAAO0E,iBAAkB,GACxB,KACHhE,EAAc4F,WACdtG,EAAOkB,gBAAkB,IA0D7B,IAAIqF,GAAc,WAChBtG,EAAO4E,GAAG,WAGZR,GAAGmC,YAAc,WACfD,KAGFlC,EAAGoC,SAAW,WACZxG,EAAO4E,GAAG,SAGZR,EAAGqC,aAAe,WAChB,GAAIC,GAAUrG,EAAQqG,QAAQ,iDAC1BA,IACF1G,EAAO4E,GAAG,SAIdR,EAAGuC,YAAc,WACf,GAAIjC,GAAOpE,EAAYqE,SACvB,IAAID,EAAKkC,qBAAuBlC,EAAKmC,yBAA0B,CAE7D,GAAIC,GAAoB,0CACpBC,EAAqB,6BAErBC,EAAa,EAEbtC,GAAKkC,sBACPI,EAAaF,EAAoBpC,EAAKkC,qBAIpClC,EAAKmC,2BACPG,EAAaD,EAAqBrC,EAAKmC,0BAKf,QAAtBrG,EAAea,IAAsC,YAAtBb,EAAea,GAChDhB,EAAQ4G,KAAKD,EAAY,WAEzB3G,EAAQ4G,KAAKD,EAAY,YAhLjClH,EAAiBoH,SAAW,SAAU,SAAU,eAAgB,OAAQ,WAAY,YAAa,UAAW,cAAe,gBAAiB,iBAAkB,gBAAiB,sBAAuB,YAAa,aAAc,MAAjOzH,QACGC,OAAO,aACPyH,WAAW,mBAAoBrH,MAiRpC,WACE,YAEAL,SACGC,OAAO,aACP0H,UAAU,aAAc,SAAU,SAAUC,GAC3C,OACIC,SAAU,IACVC,KAAM,SAASC,EAAOjE,EAASkE,GAC3B,GAAIC,GAAQL,EAAOI,EAAME,WACrBC,EAAcF,EAAMG,MAExBtE,GAAQuE,KAAK,SAAU,WACnBN,EAAMxG,OAAO,WACT4G,EAAYJ,EAAOjE,EAAQ,GAAGuB,MAAM,gBAY1D,WACE,YAOA,SAASiD,GAAuBhI,EAAQiI,EAAYhI,EAAQG,EAAU8H,EAAW/H,EAAMgI,EAAMC,EAAQ7H,EAAaD,EAASK,GAmDzH,QAAS0H,GAAY/E,GACnBgF,GAAkB,EAElBjE,EAAGkE,mBAAoB,EAGvBnI,EAAS,WACPkI,GAAkB,GACjB,KAEH,IAAIjH,IACFmH,IAAKlF,EAAKkF,IACVlD,KAAMhC,EAAKgC,KACXmD,YAAanF,EAAKmF,YAClBC,WAAYP,EAAKQ,mBAAmBrF,EAAKkF,KACzCI,SAAUtF,EAAKsF,SAGjBxI,GAAS,WACPJ,EAAOiB,OAAO,WACZoD,EAAGU,MAAM8D,QAAQxH,GACjBgD,EAAGyE,SAAWzH,EAGdgD,EAAGU,MAAQV,EAAGU,MAAMgE,MAAM,EAAG,IAG7BC,IAGA5I,EAAS,WACPiE,EAAGkE,mBAAoB,GACtB,MAEClE,EAAGU,MAAM,KACXV,EAAGU,MAAM,GAAG6D,UAAW,OAyD/B,QAASK,KACP,GAAIX,EAAiB,CAOnB,GAAIY,GAAQ7E,EAAGU,MAAM,EACrBV,GAAGU,MAAMoE,QAELD,GACF7E,EAAGU,MAAMoB,KAAK+C,IAQpB,QAASF,KACPhJ,EAAOoJ,kBAAoB9I,EAAQ+I,YACnCrJ,EAAOsJ,iBAAmBhJ,EAAQiJ,WAClCvJ,EAAOwJ,gBAAkBxJ,EAAOsJ,iBAEhClJ,EAAS,WAEPJ,EAAOwJ,gBAA4C,GAA1BxJ,EAAOsJ,kBAC/B,MA1KL,GAAIjF,GAAKC,KAELmF,EAAoB,SAAUC,GAChC/I,EAAoBQ,IAAI,cAAeuI,IAErCC,EAAchJ,EAAoBiJ,IAAI,cACrCD,KACHA,KACAF,EAAkBE,IAIpBtF,EAAGwF,SACHxF,EAAGwF,MAAMC,yBAA0B,EAEnCzF,EAAG0F,SAAW,WAEd1F,EAAG2F,WAAY,EAEf3F,EAAGU,SACC4E,EAAYjE,SACdrB,EAAGU,MAAQrF,QAAQuK,KAAKN,IAE1BtF,EAAGyE,SAAW,IAGd,IAAInE,GAAOpE,EAAYqE,SAElBD,IACH1E,EAAO4E,GAAG,OAGZ,IAEIqF,IAFevF,EAAKwF,SAEf,KAKT,IAJIxF,GAAQA,EAAKuF,KACfA,EAAKvF,EAAKuF,IAGPA,EAAL,CAIIvF,EAAKyF,QACP/F,EAAG+F,MAAQzF,EAAKyF,MAGlB,IAAIC,GAAW,OAASH,CAyDxB,IAVAI,SAASC,GAAG,eAAgB,SAASC,GACnCrK,EAAK+C,KAAK,WAAYsH,GAEtBnC,EAAYmC,EAAQlH,QAItBnD,EAAK+C,KAAK,wBAAyBoH,SAASG,YAGvCH,SAASG,UAAW,CACvB,GAAIC,IAAc,CAElBtC,GAAOmC,GAAG,UAAW,WACnBpK,EAAK+C,KAAK,8BACVkF,EAAOuC,KAAK,qBAAuBN,SAAUA,IAC1CjE,KAAK,SAAUwE,GACdzK,EAAK+C,KAAK,eAAgB0H,GAC1BF,GAAc,GACb,SAAUE,GACXzK,EAAKkF,MAAM,mBAAoBuF,OAKrCxK,EAAS,WACFsK,IACHvK,EAAK+C,KAAK,6BACVkF,EAAOuC,KAAK,qBAAuBN,SAAUA,IAC1CjE,KAAK,SAAUwE,GACdzK,EAAK+C,KAAK,8BAA+B0H,GACzCF,GAAc,GACb,SAAUE,GACXzK,EAAKkF,MAAM,kCAAmCuF,OAGnD,KAGHxC,EAAOmC,GAAG,wBAAyB,SAAUM,GAC3C1K,EAAK+C,KAAK,wBAAyB2H,GAEnCxC,EAAYwC,KAKhB,GAAIvC,IAAkB,CAmBtBJ,GAAUe,EAAiB,MAc3BD,GAGA,IAAI8B,GAAIpL,QAAQ8D,QAAQlD,EACxBwK,GAAE/C,KAAK,SAAU,WACf/H,EAAOiB,OAAO,WACZ+H,QAIJ3E,EAAG0G,eAAiB,SAAUC,GAC5B,GAAIC,GAAM5G,EAAGU,MAAM,EACfkG,KACFA,EAAIrC,UAAW,GAEjBvE,EAAGU,MAAM,GAAKV,EAAGU,MAAMiG,GACnB3G,EAAGU,MAAM,KACXV,EAAGU,MAAM,GAAG6D,UAAW,GAErBqC,IACF5G,EAAGU,MAAMiG,GAAOC,IAQpB5G,EAAG6G,eAAiB,WAElBjL,EAAO4E,GAAG,SAGZR,EAAG8G,WAAa,WACdlL,EAAO4E,GAAG,WAGZR,EAAG+G,2BAA4B,EAC/B/G,EAAGgH,eAAiB,WAClB,GAAI7C,GAAMvI,EAAOqL,KAAK,iBAAmBC,UAAS,GAClDjL,GAAQ4G,KAAKsB,EAAK,WAOpBnE,EAAGmH,WAAa,SAAUnK,GACxBe,QAAQC,IAAI,SAAUhB,EAEtB,IAAIoK,GAAQpH,EAAGU,MAAM2G,QAAQrK,EAGf,KAAVoK,EACEpH,EAAGU,OAASV,EAAGU,MAAMW,OAAS,EAIhCtF,EAAS,WACPuL,OAAO,cAAcC,SAAUtG,KAAK,YAAauG,MAAM,IACvDxH,EAAGU,MAAM+G,OAAO,EAAG,KAKrBzH,EAAGU,MAAM+G,OAAO,EAAG,GAGjBL,EAAQ,IAEVpH,EAAGU,MAAM+G,OAAOL,EAAO,EAK3B,IAAIM,GAAe,EAEnBpC,GAAchJ,EAAoBiJ,IAAI,cACtC,KAAK,GAAIoC,GAAI,EAAGA,EAAIrC,EAAYjE,OAAQsG,IAClCrC,EAAYqC,IAAM3K,GAChBsI,EAAYqC,GAAGxD,MAAQnH,EAAKmH,MAC9BuD,EAAeC,EAMjBD,GAAe,KACjBpC,EAAYmC,OAAOC,EAAc,GACjCtC,EAAkBE,KAOtBtF,EAAG4H,WAAa,SAAU5K,EAAMmE,GAC9B,OAAOA,EAAMqG,OACX,IAAK,GACL,GAAIJ,GAAQpH,EAAGU,MAAM2G,QAAQrK,EACzBgD,GAAG0G,eAAeU,EAClB,MACJ,KAAK,GACDpH,EAAGmH,WAAWnK,EACd,MACJ,KAAK,OA5RX2G,EAAuBb,SAAW,SAAU,aAAc,SAAU,WAAY,YAAa,OAAQ,OAAQ,SAAU,cAAe,UAAW,uBADjJzH,QACGC,OAAO,aACPyH,WAAW,yBAA0BY,MAyS1C,WACE,YAOA,SAASkE,GAAelM,EAAQC,EAAQC,EAAcE,EAAUD,EAAMO,EAAeH,EAAa4L,EAAa/D,EAAQD,EAAM7H,EAASK,GA4JpI,QAASyL,GAAe/K,GACtB8K,EAAYC,eAAe/K,EAAKmH,IAAK,SAAUC,GAC7CpH,EAAKoH,YAAcA,EACnBpH,EAAKqH,WAAaP,EAAKQ,mBAAmBtH,EAAKmH,KAC/CxI,EAAOiB,OAAO,WACgB,SAAxBhB,EAAO2E,QAAQjC,MAGjB0B,EAAGU,MAAM8D,QAAQxH,GACjBgD,EAAGyE,SAAWzH,IAGdgD,EAAGU,MAAMoB,KAAK9E,GACU,IAApBgD,EAAGU,MAAMW,SACXrB,EAAGyE,SAAWzH,IAIU,SAAxBpB,EAAO2E,QAAQjC,OAEjB0B,EAAGU,MAAQV,EAAGU,MAAMgE,MAAM,EAAG,KAIH,eAAxB9I,EAAO2E,QAAQjC,OACjBxC,EAAK+C,KAAK,aAAc7B,GACpBA,EAAKgL,WAAY,GACnBhI,EAAGiI,WAAWjL,QAOxB,QAAS2H,KACPhJ,EAAOoJ,kBAAoB9I,EAAQ+I,YACnCrJ,EAAOsJ,iBAAmBhJ,EAAQiJ,WACN,SAAxBtJ,EAAO2E,QAAQjC,OACjB3C,EAAOwJ,gBAAkBxJ,EAAOsJ,iBAChClJ,EAAS,WAEPJ,EAAOwJ,gBAA4C,GAA1BxJ,EAAOsJ,kBAC/B,MArMP,GAAIjF,GAAKC,KAGLmF,EAAoB,SAAUC,GAChC/I,EAAoBQ,IAAI,cAAeuI,GAGzCrF,GAAG0F,SAAW,OAEd,IAAIJ,GAAchJ,EAAoBiJ,IAAI,cACrCD,KACHA,KACAF,EAAkBE,IAGpBvH,QAAQC,IAAI,UAAWnC,GAEvBmE,EAAGU,SACyB,SAAxB9E,EAAO2E,QAAQjC,MACbgH,GAAeA,EAAYjE,OAAS,IACtCrB,EAAGU,MAAQ4E,GAGftF,EAAGyE,SAAW,KAGdzE,EAAGwF,SAEHxF,EAAGkE,mBAAoB,CAEvB,IAAIgE,GAAerM,EAAaiK,UAAYjK,EAAaqM,cAAgB5L,EAAoBiJ,IAAI,QAAQO,SACrG5F,EAAgBrE,EAAasE,WAEL,eAAxBvE,EAAO2E,QAAQjC,MAAiD,qBAAxB1C,EAAO2E,QAAQjC,QACzD0B,EAAGmI,cAAe,EAIpB,IAAI7H,GAAOpE,EAAYqE,SAElBD,IACH1E,EAAO4E,GAAG,OAGZ,IAAIqF,GAAK,IAKT,IAJIvF,GAAQA,EAAKuF,KACfA,EAAKvF,EAAKuF,IAGPA,EAAL,CAIIvF,EAAKyF,QACP/F,EAAG+F,MAAQzF,EAAKyF,MAGlB,IAAIC,GAAW,OAASH,CAKxBlK,GAAOyM,IAAI,WAAY,WACrBrE,EAAAA,UAAc,uBAAyBiC,SAAUA,IAC9CjE,KAAK,SAAUwE,GACdzK,EAAK+C,KAAK,gBAAiB0H,IAC1B,SAAUA,GACXzK,EAAKkF,MAAM,oBAAqBuF,KAEpCxC,EAAOsE,qBAEHC,GACFvM,EAASwM,OAAOD,IAIpB,IAAIjC,IAAc,CAElBtC,GAAOmC,GAAG,UAAW,WACnBpK,EAAK+C,KAAK,qCACVkF,EAAOuC,KAAK,qBAAuBN,SAAUA,IAC1CjE,KAAK,SAAUwE,GACdzK,EAAK+C,KAAK,eAAgB0H,GAC1BF,GAAc,GACb,SAAUE,GACXzK,EAAKkF,MAAM,mBAAoBuF,OAKrCxK,EAAS,WACFsK,GACHtC,EAAOuC,KAAK,qBAAuBN,SAAUA,IAC1CjE,KAAK,SAAUwE,GACdzK,EAAK+C,KAAK,8BAA+B0H,GACzCF,GAAc,GACb,SAAUE,GACXzK,EAAKkF,MAAM,kCAAmCuF,MAGnD,IAGH,IAAI+B,GAAqB,IAEzBvE,GAAOmC,GAAG,SAAU,SAAUxF,GAC5B5E,EAAK+C,KAAK,SAAU6B,GAEpBiE,IAEA3E,EAAGkE,mBAAoB,EAEvBnI,EAAS,WACPiE,EAAGkE,mBAAoB,GACtB,KAEClE,EAAGU,MAAM,KACXV,EAAGU,MAAM,GAAG6D,UAAW,EAGzB,KAAK,GAAIoD,GAAI,EAAGA,EAAIjH,EAAMW,OAAQsG,IAChCI,EAAerH,EAAMiH,MAKzB5D,EAAOmC,GAAG,wBAAyB,SAAUM,GAC3C1K,EAAK+C,KAAK,wBAAyB2H,GAGP,eAAxB5K,EAAO2E,QAAQjC,MACjB0B,EAAGU,MAAMmB,QAAQ,SAAS2G,GACpBA,EAAarE,MAAQqC,EAAarC,MACpCqE,EAAaR,SAAU,EACvBhI,EAAGiI,WAAWO,GACd1M,EAAK+C,KAAK,sCAAuC2J,QAKzDzE,EAAOmC,GAAG,2BAA4B,SAAUuC,GAC9C3M,EAAK+C,KAAK,2BAA4B4J,GAGV,eAAxB7M,EAAO2E,QAAQjC,MACjB0B,EAAGU,MAAMmB,QAAQ,SAAS2G,GACpBA,EAAarE,MAAQsE,EAAgBtE,MACvCnE,EAAG0I,aAAaF,GAChB1M,EAAK+C,KAAK,2CAA4C2J,QAsD9D7D,GAGA,IAAI8B,GAAIpL,QAAQ8D,QAAQlD,EACxBwK,GAAE/C,KAAK,SAAU,WACf/H,EAAOiB,OAAO,WACZ+H,QAIJ3E,EAAG0G,eAAiB,SAAUC,GAC5B,GAAIC,GAAM5G,EAAGU,MAAM,EACnBkG,GAAIrC,UAAW,EACfvE,EAAGU,MAAM,GAAKV,EAAGU,MAAMiG,GACnB3G,EAAGU,MAAM,KACXV,EAAGU,MAAM,GAAG6D,UAAW,GAErBqC,IACF5G,EAAGU,MAAMiG,GAAOC,IAIpB5G,EAAGmH,WAAa,SAAUnK,GACxBe,QAAQC,IAAI,iBAAkBhB,IAGhCgD,EAAG6G,eAAiB,WAElBjL,EAAO4E,GAAG,iBAGZR,EAAG8G,WAAa,WACdlL,EAAO4E,GAAG,WAGZR,EAAGiI,WAAa,SAAUjL,GAGxBsI,EAAchJ,EAAoBiJ,IAAI,eACtCD,EAAYd,QAAQxH,GACpBoI,EAAkBE,EAElB,KAEMW,SAASG,UACXH,SAAS0C,UAAU,eAAgB3L,EAAM,MAEzClB,EAAK+C,KAAK,0FAEZ,MAAOxB,GACPvB,EAAKkF,MAAM3D,GAIe,qBAAxBzB,EAAO2E,QAAQjC,MAA+B4J,GAAgBhI,GAChEhE,EAAY0M,YAAY5L,EAAMkL,EAAchI,EAAe,SAAUlD,EAAMgE,GACrEA,EACFlF,EAAKkF,MAAM,gCAAiCA,GAE5ClF,EAAK+C,KAAK,mBAAoB7B,IAMpC,IAAIoK,GAAQpH,EAAGU,MAAM2G,QAAQrK,EACzBoK,GAAQ,IACVpH,EAAGU,MAAM+G,OAAOL,EAAO,IAO3BpH,EAAG0I,aAAe,SAAU1L,GAE1B,GAAIoK,GAAQpH,EAAGU,MAAM2G,QAAQrK,EACzBoK,GAAQ,IACVpH,EAAGU,MAAM+G,OAAOL,EAAO,GAOG,qBAAxBxL,EAAO2E,QAAQjC,MAA+B4J,GAAgBhI,GAChEhE,EAAY2M,eAAe7L,EAAMkL,EAAchI,EAAe,SAAUlD,EAAMgE,GACxEA,EACFlF,EAAKkF,MAAM,mCAAoCA,GAE/ClF,EAAK+C,KAAK,sBAAuB7B,MASzCgD,EAAG4H,WAAa,SAAU5K,EAAMmE,GAC9B,GAAIiG,GAAQpH,EAAGU,MAAM2G,QAAQrK,EAE7B,QAAOmE,EAAMqG,OACX,IAAK,GACDxH,EAAG0G,eAAeU,EAClB,MACJ,KAAK,GAEa,IAAVA,EACFzL,EAAOiB,OAAO,WACdoD,EAAGU,MAAMoE,UAULsC,EAAQ,IAEVpH,EAAGU,MAAM+G,OAAOL,EAAO,EAG3B,MACJ,KAAK,OA5UXS,EAAe/E,SAAW,SAAU,SAAU,eAAgB,WAAY,OAAQ,gBAAiB,cAAe,cAAe,SAAU,OAAQ,UAAW,uBAF9JzH,QACGC,OAAO,aACPyH,WAAW,iBAAkB8E,MAyVlC,WACE,YAEAxM,SACGC,OAAO,aACP0H,UAAU,UAAW,WACpB,OACE8F,SAAU,GACV3F,KAAM,SAASC,EAAOjE,EAAS4J,GAE7BA,EAAKC,SAAS,UAAW,SAASrM,GACnB,SAATA,EACFwC,EAAQ,GAAG8J,OAAQ,EAGnB9J,EAAQ,GAAG8J,OAAQ,WAYjC,WACE,YAEA5N,SACGC,OAAO,aACP0H,UAAU,aAAc,WACvB,OACE8F,SAAU,GACV3F,KAAM,SAASC,EAAOjE,EAAS4J,GAE7BA,EAAKC,SAAS,aAAc,SAASrM,GACtB,SAATA,EACFwC,EAAQ,GAAGoF,UAAW,EAGtBpF,EAAQ,GAAGoF,UAAW,WAYpC,WACE,YAOA,SAASuD,GAAYhM,GAEnB,QAASiM,GAAemB,EAAUC,GAChC,GAAIC,GAAM,GAAIC,eACdD,GAAIvG,KAAK,MAAOqG,GAAU,GAC1BE,EAAIE,aAAe,cACnBF,EAAIhM,OAAS,SAASC,GACpB,GAAIkM,GAAc,GAAIC,YAAWvJ,KAAKwJ,UAClCC,EAAWC,KAAKC,mBAAmBL,EAAYM,OAEnD/N,GAAK+C,KAAK6K,GAEVP,EAASW,SAASJ,EAASK,aAAe,EAAG,MAE/CX,EAAIY,OAGN,OACEjC,eAAgBA,GApBpBD,EAAYhF,SAAW,QAHvBzH,QACKC,OAAO,aACP2O,QAAQ,cAAenC,MA2B9B,WACE,YAOA,SAASoC,GAAkBvO,EAAQC,EAAQU,EAAqBP,EAAUQ,GACxE,GAAIyD,GAAKC,IAETD,GAAGmK,MAAQ,GACXnK,EAAGoK,YAAc,GAEb9N,EAAoBiJ,IAAI,kBAC1BvF,EAAGmK,MAAQ7N,EAAoBiJ,IAAI,iBAGjCjJ,EAAoBiJ,IAAI,wBAC1BvF,EAAGoK,YAAc9N,EAAoBiJ,IAAI,uBAG3CvF,EAAGqK,6BAA+B,WAGhC,MAAIrK,GAAGmK,QAAU5N,EAAU+N,aAAatK,EAAGmK,QACzCnK,EAAGuK,cAAe,MAElBxO,GAAS,WACPiE,EAAGuK,cAAe,GACjB,OAKLxM,QAAQC,IAAIgC,EAAGmK,MAAOnK,EAAGoK,aAGzB9N,EAAoBQ,IAAI,eAAgBkD,EAAGmK,MAAQnK,EAAGmK,MAAQ,IAC9D7N,EAAoBQ,IAAI,qBAAsBkD,EAAGoK,YAAcpK,EAAGoK,YAAc,QAEhFxO,GAAO4E,GAAG,YAlCd0J,EAAkBpH,SAAW,SAAU,SAAU,sBAAuB,WAAY,aAJpFzH,QACGC,OAAO,aACPyH,WAAW,oBAAqBmH,MA0CrC,WACE,YAOA,SAASM,GAAe7O,IAAxB6O,EAAe1H,SAAW,UAL1BzH,QACGC,OAAO,aACPyH,WAAW,iBAAkByH,MAWlC,WACE,YAOA,SAASC,GAAe9O,EAAQC,EAAQC,EAAcE,EAAUD,EAAMO,EAAeH,EAAaI,GAChG,GAAI0D,GAAKC,IAETD,GAAG8F,SAAW,GACd9F,EAAG0K,mBAAoB,EAEvB1K,EAAG2K,IAAM,GACT3K,EAAG4K,cAAe,CAClB,IAAIC,GAAe,EAEnBlP,GAAOmP,YAAc,SAAUH,GAC7B3K,EAAG2K,IAAMA,EACT3K,EAAG+K,UAAW,EACdjP,EAAKkC,IAAI,QAAS2M,GACI,IAAlB3K,EAAG2K,IAAItJ,QACLwJ,IAAiB7K,EAAG2K,KACtBzO,EAAY8O,KAAKhL,EAAGM,KAAKuF,GAAI7F,EAAG8F,SAAU9F,EAAG2K,IAAK,SAAUrK,EAAMU,GAChE,GAAIA,EACFhB,EAAG+K,UAAW,EACdF,EAAe7K,EAAG2K,QACb,CACL3K,EAAGM,KAAOA,CAGV,IAAIgF,KACJhJ,GAAoBQ,IAAI,cAAewI,GAEvC1J,EAAO4E,GAAG,UAEZnE,EAAc4F,cAMtBjC,EAAG8G,WAAa,WACd9G,EAAGiL,eAAgB,EACnBjL,EAAG4K,cAAe,EAClB5K,EAAGM,KAAO,KACVjE,EAAcsF,QAEd3B,EAAG8F,SAAW9F,EAAG8F,SAASoF,cAE1BhP,EAAY2C,KAAKmB,EAAG8F,SAAU,SAAUxF,EAAMU,GAE5C,GADAlF,EAAKkC,IAAIsC,EAAMU,GACXA,EACFhB,EAAGiL,eAAgB,MAGnB,IADAjL,EAAGM,KAAOA,EACLA,EAAK6K,OAQRnL,EAAG4K,cAAe,MARF,CAGhB,GAAItF,KACJhJ,GAAoBQ,IAAI,cAAewI,GAEvC1J,EAAO4E,GAAG,UAKdnE,EAAc4F,cAIdpG,EAAaqM,eACflI,EAAG8F,SAAWjK,EAAaqM,aAC3BlI,EAAG8G,cAGL9G,EAAGoL,UAAY,EAEfpL,EAAGqL,QAAU,SAAUC,GACjBtL,EAAGoL,YAAcE,EACnBtL,EAAGoL,UAAY,EAEfpL,EAAGoL,UAAYE,GA1ErBb,EAAe3H,SAAW,SAAU,SAAU,eAAgB,WAAY,OAAQ,gBAAiB,cAAe,uBANlHzH,QACGC,OAAO,aACPyH,WAAW,iBAAkB0H,MAqFlC,WACE,YAEApP,SACGC,OAAO,aACP0H,UAAU,WAAA,WAAW,SAASjH,GAC7B,OACIoH,KAAM,SAAWC,EAAOjE,EAASkE,GAC7BD,EAAMmI,OAAQlI,EAAMmI,QAAS,SAAWC,GAC/BpQ,QAAQqQ,UAAWD,IAASA,GAC7B1P,EAAU,WAAcoD,EAAQ,GAAGwM,YAExC,WAUjB,WACE,YAEAtQ,SACGC,OAAO,2BAIZ,WACE,YAOA,SAASiB,KAIP,QAAS+N,GAAaH,GAEpB,MAAKA,IAA0B,IAAjBA,EAAM9I,OAGbuK,EAAaC,KAAK1B,IAFhB,EALX,GAAIyB,GAAe,qFAUnB,QACEtB,aAAcA,GAlBlBjP,QACGC,OAAO,qBACP2O,QAAQ,YAAa1N,MAwB1B,WACE,YAOA,SAASuP,KAEP,QAASC,GAA6BC,GAClC,GAAIC,GAAS,GACTC,IAELA,GAAE,KAAK,KAAKA,EAAE,KAAK,IAAIA,EAAE,KAAK,KAAKA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,KAAKA,EAAE,KAAK,MAAMA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAChJA,EAAE,KAAK,KAAKA,EAAE,KAAK,IAAIA,EAAE,KAAK,KAAKA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,KAAKA,EAAE,KAAK,MAAMA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAChJA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,KAAKA,EAAE,KAAK,IACtHA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,KAAKA,EAAE,KAAK,IACtHA,EAAE,KAAK,KAAKA,EAAE,KAAK,KAAKA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,KACjGA,EAAE,KAAK,KAAKA,EAAE,KAAK,KAAKA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAAIA,EAAE,KAAK,IAEjG,KAAK,GAAIvE,KAAKqE,GACRA,EAAKG,eAAexE,KAEpBsE,GADiBG,SAAfF,EAAEF,EAAKrE,IACCqE,EAAKrE,GAELuE,EAAEF,EAAKrE,IAIvB,OAAOsE,GAGV,QAASI,GAAmBC,GAyF1B,IAAI,GAvFAC,KACDC,KAAO,IAAKC,QAAU,oNACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,0BACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,oBACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,8DACtBD,KAAO,IAAKC,QAAU,gFACtBD,KAAO,IAAKC,QAAU,4FACtBD,KAAO,KAAKC,QAAU,oBACtBD,KAAO,KAAKC,QAAU,oBACtBD,KAAO,IAAKC,QAAU,4LACtBD,KAAO,IAAKC,QAAU,4CACtBD,KAAO,IAAKC,QAAU,kGACtBD,KAAO,IAAKC,QAAU,4FACtBD,KAAO,IAAKC,QAAU,gIACtBD,KAAO,IAAKC,QAAU,sCACtBD,KAAO,IAAKC,QAAU,4FACtBD,KAAO,IAAKC,QAAU,oHACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,wDACtBD,KAAO,IAAKC,QAAU,wGACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,0QACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,oEACtBD,KAAO,IAAKC,QAAU,4CACtBD,KAAO,IAAKC,QAAU,8GACtBD,KAAO,IAAKC,QAAU,8GACtBD,KAAO,IAAKC,QAAU,kGACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,oNACtBD,KAAO,IAAKC,QAAU,wDACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,oEACtBD,KAAO,IAAKC,QAAU,sCACtBD,KAAO,IAAKC,QAAU,kGACtBD,KAAO,IAAKC,QAAU,4FACtBD,KAAO,IAAKC,QAAU,0NACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,0BACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,oBACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,8DACtBD,KAAO,IAAKC,QAAU,sFACtBD,KAAO,IAAKC,QAAU,4FACtBD,KAAO,KAAKC,QAAU,oBACtBD,KAAO,IAAKC,QAAU,kMACtBD,KAAO,IAAKC,QAAU,4CACtBD,KAAO,IAAKC,QAAU,kGACtBD,KAAO,IAAKC,QAAU,kGACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,gIACtBD,KAAO,IAAKC,QAAU,4CACtBD,KAAO,IAAKC,QAAU,4FACtBD,KAAO,IAAKC,QAAU,0HACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,wDACtBD,KAAO,IAAKC,QAAU,8GACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAKC,QAAU,0QACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAIC,QAAU,oEACrBD,KAAO,IAAIC,QAAU,4CACrBD,KAAO,IAAIC,QAAU,8GACrBD,KAAO,IAAIC,QAAU,oHACrBD,KAAO,IAAIC,QAAU,wGACrBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAIC,QAAU,oNACrBD,KAAO,IAAIC,QAAU,wDACrBD,KAAO,KAAKC,QAAU,cACtBD,KAAO,IAAIC,QAAU,0EACrBD,KAAO,IAAIC,QAAU,sCACrBD,KAAO,IAAIC,QAAU,wGACrBD,KAAO,IAAIC,QAAU,4FAGhB9E,EAAE,EAAGA,EAAE4E,EAA4BlL,OAAQsG,IACjD2E,EAAMA,EAAII,QAAQH,EAA4B5E,GAAG8E,QAASF,EAA4B5E,GAAG6E,KAG3F,OAAOF,GAIT,QAASK,GAA6BL,GACpC,MAAOA,GAAII,QAAQ,MAAO,KAG5B,QAASE,GAAoDN,GAC3D,MAAOA,GAAII,QAAQ,oBAAqB,IAG1C,QAASG,GAAeP,GAGtB,MAFAA,GAAMP,EAA6BO,GACnCA,EAAMD,EAAkBC,GAI1B,QAASQ,GAAgBR,GAIvB,MAHAA,GAAMO,EAAeP,GACrBA,EAAMK,EAA6BL,GACnCA,EAAMM,EAAoDN,GAK5D,OACEQ,gBAAiBA,GAtJrBzR,QACGC,OAAO,qBACP2O,QAAQ,gBAAiB6B,MA4J9B,WACE,YAOA,SAAS5M,KACP,MAAO,UAAU6N,EAAOC,GACtBA,EAAOA,GAAQ,QACfD,EAAQA,GAAS,EACjB,IAAIE,GAAM,GAINC,EAAWH,EAAMI,MAAM,KACvBC,EAAgBF,EAASA,EAAS7L,OAAS,GAAG8L,MAAM,IAExD,IAAa,UAATH,EAAkB,CACpB,GAAI5C,GAAcgD,EAAc,GAAGV,QAAQ,KAAM,IAC7CtC,GAAYiD,MAAM,eAElBJ,EADE7C,EAAYiD,MAAM,KACdjD,EAEA,IAAMA,OAIhB6C,GAAMF,CAGR,OAAOE,IA7BX5R,QACGC,OAAO,qBACPgS,OAAO,WAAYpO,MAoCxB,WACE,YAOA,SAAShD,GAAYqR,EAAKC,EAAOlR,GAI/B,QAASiE,KACP,GAAID,GAAOhE,EAAoBiJ,IAAI,OACnC,OAAOjF,GAGT,QAASzB,GAAMiH,EAAUqD,GACvB,GAAIsE,GAAaC,EAAa,aAE1BC,EAAK,GAAIC,SACbD,GAAGE,OAAO,WAAY/H,GAEtB0H,EAAMlH,KAAKmH,EAAYE,GACrBG,iBAAkBzS,QAAQ0S,SAC1BC,SACEC,eAAgB7B,UAGnB8B,QAAQ,SAAUzE,GACjB,IAAKA,IAAaA,EAASxK,KACzB,MAAOkK,GAAS,MACd3L,KAAM,QAGV,IAAI8C,GAAOmJ,EAASxK,IAEpB3C,GAAoBQ,IAAI,OAAQwD,GAEhC6I,EAAS7I,KAEVU,MAAM,SAAUyI,GACfN,EAAS,MACP3L,KAAM,WAKZ,QAASwN,GAAMnF,EAAIC,EAAU6E,EAAKxB,GAChC,GAAIsE,GAAaC,EAAa,aAE1BC,EAAK,GAAIC,SACbD,GAAGE,OAAO,KAAMhI,GAChB8H,EAAGE,OAAO,WAAY/H,GACtB6H,EAAGE,OAAO,MAAOlD,GAEjB6C,EAAMlH,KAAKmH,EAAYE,GACrBG,iBAAkBzS,QAAQ0S,SAC1BC,SACEC,eAAgB7B,UAGnB8B,QAAQ,SAAUzE,GACjB,IAAKA,IAAaA,EAASxK,KACzB,MAAOkK,GAAS,MACd3L,KAAM,QAGV,IAAI8C,GAAOmJ,EAASxK,IAEpB3C,GAAoBQ,IAAI,OAAQwD,GAEhC6I,EAAS7I,KAEVU,MAAM,SAAUyI,GACfN,EAAS,MACP3L,KAAM,WAKZ,QAAS2Q,GAAgBnR,EAAM8I,EAAU3F,EAAWgJ,EAAUiF,GAC5D,GAAIX,GAAaC,EAAa,qBAE1BW,GACFrR,KAAMA,EACN8I,SAAUA,EACV3F,UAAWA,EAGTiO,KACFC,EAAOD,YAAa,GAGtBZ,EAAMlH,KAAKmH,EAAYY,GACtBH,QAAQ,SAAUzE,GACjBN,EAASM,EAASxK,QAEnB+B,MAAM,SAAUyI,EAAU6E,GACzBnF,EAAS,MACPmF,OAAQA,EACRC,QAAS9E,EAAS8E,YAKxB,QAAS3F,GAAa5L,EAAM8I,EAAU3F,EAAWgJ,GAC/CgF,EAAenR,EAAM8I,EAAU3F,EAAWgJ,GAG5C,QAASN,GAAgB7L,EAAM8I,EAAU3F,EAAWgJ,GAClDgF,EAAenR,EAAM8I,EAAU3F,EAAWgJ,GAAU,GArGtD,GAAIuE,GAAaH,EAAI/R,UAwGrB,QACE+E,QAASA,EACT1B,KAAMA,EACNmM,KAAMA,EACNpC,YAAaA,EACbC,eAAgBA,GA7GpB3M,EAAY4G,SAAW,MAAO,QAAS,uBAPvCzH,QACKC,OAAO,aACP2O,QAAQ,cAAe/N,MA0H9B,WACE,YAOA,SAASC,GAAcoR,EAAKC,EAAOlR,EAAqBR,EAAMgQ,GAI5D,QAAS0C,KACP,GAAIC,GAAS,GAETC,EAAepS,EAAoBiJ,IAAI,gBACvCoJ,EAAqBrS,EAAoBiJ,IAAI,qBAUjD,OARIoJ,KAAuBA,EAAmB3P,WAAW,OACvDyP,GAAUE,EAAqB,KAG7BD,IAAiBA,EAAa1P,WAAW,OAC3CyP,GAAUC,EAAe,KAGpB5C,EAAcgB,gBAAgB2B,GAGvC,QAASG,GAAYlO,EAAOyI,EAAU0F,EAAgB3O,GACpD,GAAI4O,GAAYpB,EAAa,UAEzBC,EAAK,GAAIC,UAETtN,EAAOhE,EAAoBiJ,IAAI,OACnCoI,GAAGE,OAAO,UAAWvN,EAAKuF,IAC1B8H,EAAGE,OAAO,gBAAiBvN,EAAKwF,UAChC6H,EAAGE,OAAO,WAAYvN,EAAKqK,KACvBzK,GACFyN,EAAGE,OAAO,kBAAmB3N,GAE/ByN,EAAGE,OAAO,SAAUW,IAEpB,KAAK,GAAI7G,GAAI,EAAGA,EAAIjH,EAAMW,OAAQsG,IAChCgG,EAAGE,OAAO,QAASnN,EAAMiH,GAG3B7L,GAAK+C,KAAK,iBAEV,IAAIuK,GAAM,GAAIC,eAEdD,GAAI2F,OAAOC,iBAAiB,WAAYH,GAAgB,GAExDzF,EAAI4F,iBAAiB,mBAAoB,SAAU3R,GAEjD,GAAwB,IAApB4C,KAAKgP,WAAkB,CACzBnT,EAAK+C,KAAK,uBAAwBxB,EAElC,IAAIoM,GAAWpM,EAAEyB,OAAO2K,QAExB,IAAIA,EACF,IACEA,EAASyF,KAAKC,MAAM1F,GACpB,MAAOpM,GACPvB,EAAKkF,MAAM,eAAgB3D,GAI/B8L,GAAS,EAAOM,MAMpBL,EAAI4F,iBAAiB,QAAS,SAAU3R,GACtCvB,EAAKkF,MAAM,uBAAwB3D,GACnC8L,GAAS,KAGXC,EAAIvG,KAAK,OAAQiM,GAGjB1F,EAAIY,KAAK2D,GAxEX,GAAID,GAAaH,EAAI/R,UA4ErB,QACEkF,MAAOkO,GA5EXzS,EAAc2G,SAAW,MAAO,QAAS,sBAAuB,OAAQ,iBARxEzH,QACKC,OAAO,aACP2O,QAAQ,gBAAiB9N,MAwFhC,WACE,YAOA,SAASiT,GAAStT,EAAM8H,EAAY3H,GAIA,YAA9BA,EAAQmE,SAASiP,UAAwD,uBAA9BpT,EAAQmE,SAASiP,SAC9DzL,EAAW+B,UAAY,OAEvB/B,EAAW+B,UAAY,QAGzB7J,EAAKwT,MAAM,gBANbF,EAAStM,SAAW,OAAQ,aAAc,WAT1CzH,QACGC,OAAO,aACPiU,IAAIH,MAkBT,WACE,YAOA,SAASI,GAAaC,EAAgBC,GACpCD,EACGE,MAAM,QACLxL,IAAK,IACLyL,YAAa,qBACb7M,WAAY,iBACZ8M,aAAc,SAEfF,MAAM,QACLxL,IAAK,QACLyL,YAAa,qBACb7M,WAAY,iBACZ8M,aAAc,SAEfF,MAAM,WACLxL,IAAK,UACLyL,YAAa,2BACb7M,WAAY,oBACZ8M,aAAc,YAEfF,MAAM,UACLxL,IAAK,UACLyL,YAAa,yBACb7M,WAAY,mBACZ8M,aAAc,WAEfF,MAAM,uBACLxL,IAAK,qBACLyL,YAAa,yBACb7M,WAAY,mBACZ8M,aAAc,WAEfF,MAAM,WACLxL,IAAK,aACLyL,YAAa,qBACb7M,WAAY,iBACZ8M,aAAc,SAEfF,MAAM,cACLxL,IAAK,mBACLyL,YAAa,qBACb7M,WAAY,iBACZ8M,aAAc,SAEfF,MAAM,oBACLxL,IAAK,wCACLyL,YAAa,qBACb7M,WAAY,iBACZ8M,aAAc,SAEfF,MAAM,gBACLxL,IAAK,qBACLyL,YAAa,qBACb7M,WAAY,yBACZ8M,aAAc,SAEfF,MAAM,sBACLxL,IAAK,mCACLyL,YAAa,qBACb7M,WAAY,yBACZ8M,aAAc,SAEfF,MAAM,QACLxL,IAAK,UACLyL,YAAa,qBACb7M,WAAY,iBACZ8M,aAAc,SAEbF,MAAM,cACLxL,IAAK,wBACLyL,YAAa,qBACb7M,WAAY,iBACZ8M,aAAc,SAEjBF,MAAM,8BACLxL,IAAK,iBACLyL,YAAa,qBACb7M,WAAY,iBACZ8M,aAAc,SAGlBH,EAAmBI,UAAU,KA5E/BN,EAAa1M,SAAW,iBAAkB,sBAV1CzH,QACGC,OAAO,aACPyU,OAAOP,MA0FZ,WACE,YAEAnU,SACGC,OAAO,aACPC,SAAS,aAAc,uBAI5B,WACE,YAaA,SAASwU,GAAOC,EAAcC,EAAmBC,EAA6BC,GAE5EH,EAAaI,cAAa,GAG1BH,EAAkBI,WAAU,GAAMC,WAAW,KAG7CJ,EACGK,UAAU,aAEbJ,EAAsBK,eAAgB,EAXxCT,EAAOjN,SAAW,eAAgB,oBAAqB,8BAA+B,yBAXtFzH,QACGC,OAAO,aACPyU,QAAA,iBAAA,MAAO,SAAUU,EAAgBlD,GAChCkD,EAAetM,IAAMoJ,EAAI/R,cAE1BuU,QAAA,gBAAA,MAAO,SAAUW,EAAenD,GAC/BmD,EAAcjV,cAAc8R,EAAI9R,kBAEjCsU,OAAOA,MAmBZ1U,QAAQC,OAAO,aAAaiU,KAAK,iBAAkB,SAASoB,GAAiBA,EAAeC,IAAI,qBAAqB,snFACrHD,EAAeC,IAAI,qBAAqB,QACxCD,EAAeC,IAAI,2BAA2B,y3CAC9CD,EAAeC,IAAI,yBAAyB;AAC5CD,EAAeC,IAAI,qBAAqB","file":"scripts/app-aa16a6ca7a.js","sourcesContent":["angular.module(\"mediaWall.env\", [])\n\n.constant(\"ENV\", {\n \"backendUrl\": \"http://api.vjencanje.online:80\",\n \"enableLogging\": true\n})\n\n;\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall', [\n        'mediaWall.env',\n        'mediaWall.helpers',\n        'ngAnimate',\n        'ngCookies',\n        'ngTouch',\n        'ngSanitize',\n        'ngMessages',\n        'ngAria',\n        'ui.router',\n        'ngMaterial',\n        'angular-loading-bar',\n        'LocalStorageModule',\n        'ngSails',\n        'log.ex.uo',\n        'ng.deviceDetector',\n        'com.2fdevs.videogular',\n        // 'com.2fdevs.videogular.plugins.controls',\n        // 'com.2fdevs.videogular.plugins.overlayplay',\n        // 'com.2fdevs.videogular.plugins.poster',\n        'rt.asyncseries',\n        'cp.ng.fix-image-orientation'\n      ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('RecordController', RecordController);\n\n  /** @ngInject */\n  function RecordController($scope, $state, $stateParams, $log, $timeout, $mdDialog, $window, WallService, UploadService, deviceDetector, cfpLoadingBar, localStorageService, validator, eachSeries, $q) {\n    var vm = this;\n\n    $log.info('deviceDetector', deviceDetector);\n\n    var wallMasterKey = $stateParams.masterKey;\n\n    if (!wallMasterKey) {\n      // TODO(stepanic): this is hack to go to top of the window to avoid empty space\n      // because of opened keyboard from previous page\n      if (deviceDetector.os === 'ios' || deviceDetector.os === 'android' || deviceDetector.os === 'windows-phone') {\n        window.location = '/fotkaj#';\n      }\n    }\n\n    $scope.showProgressBar = false;\n\n    // REFACTORED(stepanic): this is annoying for first time users, show only on info click\n    // If currentEmail is undefined show prompts by default\n    // if (!localStorageService.get('currentEmail')) {\n    //   showInfoPrompts();\n    // }\n\n    var disableInteraction = null;\n\n    $scope.progressCounter = 0;\n\n    $scope.wall = WallService.current();\n\n    if (!$scope.wall) {\n      $state.go('home');\n    }\n\n    function applyProgress(value) {\n      $scope.$apply(function () {\n        $scope.progressCounter = value * 100;\n      });\n      cfpLoadingBar.set(value);\n    }\n\n    function showAlert (message) {\n      // TODO(stepanic): improve with $mdDialog\n      alert(message);\n    };\n\n    $scope.HandleFiles = function (files) {\n\n      $scope.showProgressBar = true;\n\n      cfpLoadingBar.start();\n      cfpLoadingBar.set(0);\n      $scope.progressCounter = 0;\n\n      var filesInArray = [];\n      angular.forEach(files, function(file) {\n        filesInArray.push (file);\n      });\n\n      var currentFileIndex = -1;\n\n      // Async series implementation for angular\n      eachSeries(filesInArray, asyncFilesUploadHandler).then(function () {\n        // All done\n        $log.info('All files are uploaded');\n\n        // Keep 100% for 0.5 second\n        setTimeout(function() {\n          applyProgress(0);\n          $scope.showProgressBar = false;\n        }, 500);\n        cfpLoadingBar.complete();\n        $scope.progressCounter = 0;\n      });\n\n\n      function asyncFilesUploadHandler (file) {\n        var deferred = $q.defer();\n\n        // TODO(stepanic): test if maybe is better to upload files in subsets of max for example 5MB\n        // this can be checked with sum of file.size\n        var separatedFiles = [file];\n\n        // Files iterator\n        currentFileIndex += 1;\n\n        UploadService.files(separatedFiles, function (error, data) {\n          $log.info(\"UploadService done\", currentFileIndex, separatedFiles, data);\n\n          if (deviceDetector.os === 'ios' || deviceDetector.os === 'android' || deviceDetector.os === 'windows-phone') {\n            if (data && data.files && data.files[0] && data.files[0].type.startsWith('video/')) {\n              // showAlert (\"Vaš video zapis je zaprimljen.\");\n            }\n          }\n\n          deferred.resolve();\n\n          // TODO(stepanic): find better way to preview uploaded files if it is necessarily\n          // this is annoying\n          // if (error) {\n          //   return;\n          // }\n\n          if (files && files[0]) {\n          //   // Images\n          //   // Open image which user can save to device or back to record\n            download(files[0]);\n          }\n        }, function uploadProgress(event) {\n          // var progress = (currentFileIndex + event.loaded / event.total) * 1 / filesInArray.length;\n\n          // Offset between other files\n          var offset = currentFileIndex / files.length;\n\n          // Local Progress for every file\n          var progress = event.loaded / event.total / files.length;\n\n          // Absolute progress 0% to 100%\n          var absoluteProgress = offset + progress;\n\n          applyProgress(absoluteProgress);\n\n        }, wallMasterKey);\n\n        // Returns a promise\n        return deferred.promise;\n      }\n\n    };\n\n    var goToProfile = function () {\n      $state.go('profile');\n    };\n\n    vm.EditProfile = function () {\n      goToProfile();\n    };\n\n    vm.GoToWall = function () {\n      $state.go('wall');\n    };\n\n    vm.GoToHomepage = function () {\n      var confirm = $window.confirm(\"Jeste li sigurni da želite izaći iz vjenčanja?\");\n      if (confirm) {\n        $state.go('home');\n      }\n    };\n\n    vm.GoToGallery = function () {\n      var wall = WallService.current();\n      if (wall.googleDriveFolderId || wall.googlePhotosAlbumShareId) {\n        // $state.go('gallery');\n        var prefixGoogleDrive = \"https://drive.google.com/drive/folders/\";\n        var prefixGooglePhotos = \"https://photos.app.goo.gl/\";\n\n        var galleryUrl = '';\n        // by default try to create Google Drive URL\n        if (wall.googleDriveFolderId) {\n          galleryUrl = prefixGoogleDrive + wall.googleDriveFolderId;\n        }\n\n        // override Google Drive with Google Photos if exists\n        if (wall.googlePhotosAlbumShareId) {\n          galleryUrl = prefixGooglePhotos + wall.googlePhotosAlbumShareId;\n        }\n\n        // iOS and Android devices usually have installed native Google Drive and/or Google Photos apps\n        // and than target=\"_blank\" on return to app show empty white screen\n        if (deviceDetector.os === 'ios' || deviceDetector.os === 'android') {\n          $window.open(galleryUrl, \"_parent\");\n        } else {\n          $window.open(galleryUrl, \"_blank\");\n        }\n      }\n    };\n\n\n    function download(file) {\n      // TODO(stepanic): skip this for files from gallery, ony from camera source\n      // iOS and Adnroid devices do not store image taken with camera, this is fix\n      // Apple has not implemented automatic download, should be triggered with user interaction with tap/click\n      if (deviceDetector.os === 'ios' || deviceDetector.os === 'android') {\n        var reader = new FileReader();\n\n        reader.onload = function (e) {\n          $log.info(e);\n\n          // Only show/download images\n          // iOS is not able to download video files in browser\n          if (deviceDetector.os === 'ios') {\n            if (!e.target.result.startsWith('data:image/')) {\n              return;\n            }\n          }\n\n          // var data = e.target.result.split('base64');\n          // data = 'data:application/octet-stream;base64' + data[1];\n\n          var data = e.target.result;\n          var filename = file.name;\n\n          var element = document.createElement('a');\n          element.setAttribute('href', data);\n          element.setAttribute('download', filename);\n\n\n          function errorHandler(e) {\n            var msg = '';\n\n            switch (e.code) {\n              case FileError.QUOTA_EXCEEDED_ERR:\n                msg = 'QUOTA_EXCEEDED_ERR';\n                break;\n              case FileError.NOT_FOUND_ERR:\n                msg = 'NOT_FOUND_ERR';\n                break;\n              case FileError.SECURITY_ERR:\n                msg = 'SECURITY_ERR';\n                break;\n              case FileError.INVALID_MODIFICATION_ERR:\n                msg = 'INVALID_MODIFICATION_ERR';\n                break;\n              case FileError.INVALID_STATE_ERR:\n                msg = 'INVALID_STATE_ERR';\n                break;\n              default:\n                msg = 'Unknown Error';\n                break;\n            };\n\n            console.log('Error: ' + msg);\n          }\n\n          function onInitFs(fs) {\n\n\n\n              (function(f) {\n                fs.root.getFile(f.name, {create: true, exclusive: true}, function(fileEntry) {\n                  fileEntry.createWriter(function(fileWriter) {\n                    fileWriter.write(f); // Note: write() can take a File or Blob object.\n                  }, errorHandler);\n                }, errorHandler);\n              })(file);\n\n            }\n\n\n\n          window.webkitStorageInfo.requestQuota(PERSISTENT, 5*1024*1024, function(grantedBytes) {\n            window.requestFileSystem(PERSISTENT, grantedBytes, onInitFs, errorHandler);\n          }, function(e) {\n            console.log('Error', e);\n          });\n\n\n          // element.style.display = 'none';\n          // document.body.appendChild(element);\n\n          // element.click();\n\n          document.body.removeChild(element);\n        }\n\n        reader.readAsDataURL(file);\n      }\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .directive('fileModel', ['$parse', function ($parse) {\n      return {\n          restrict: 'A',\n          link: function(scope, element, attrs) {\n              var model = $parse(attrs.fileModel);\n              var modelSetter = model.assign;\n\n              element.bind('change', function(){\n                  scope.$apply(function(){\n                      modelSetter(scope, element[0].files[0]);\n                  });\n              });\n          }\n      };\n    }]);\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('WallVerifiedController', WallVerifiedController);\n\n  /** @ngInject */\n  function WallVerifiedController($scope, $rootScope, $state, $timeout, $interval, $log, $sce, $sails, WallService, $window, localStorageService) {\n    var vm = this;\n\n    var updateCachedMedia = function (updatedCachedMedia) {\n      localStorageService.set('cachedMedia', updatedCachedMedia);\n    }\n    var cachedMedia = localStorageService.get('cachedMedia');\n    if (!cachedMedia) {\n      cachedMedia = [];\n      updateCachedMedia(cachedMedia);\n    }\n\n    // UI flags for show/hide\n    vm.flags = {};\n    vm.flags.enableMainFileAnimation = true;\n\n    vm.wallMode = 'verified';\n\n    vm.slideshow = true;\n\n    vm.files = [];\n    if (cachedMedia.length) {\n      vm.files = angular.copy(cachedMedia);\n    }\n    vm.mainFile = null;\n\n    // Current authenticated wall\n    var wall = WallService.current();\n\n    if (!wall) {\n      $state.go('home');\n    }\n\n    var wallPassword = wall.password;\n\n    var id = null;\n    if (wall && wall.id) {\n      id = wall.id;\n    }\n\n    if (!id) {\n      return;\n    }\n\n    if (wall.image) {\n      vm.image = wall.image;\n    }\n\n    var roomName = 'wall' + id;\n\n\n    function setNewMedia(data) {\n      isRandomAllowed = false;\n\n      vm.isActiveMainImage = true;\n\n      // New image is shown for minimal 15 seconds\n      $timeout(function() {\n        isRandomAllowed = true;\n      }, 25000);\n\n      var file = {\n        url: data.url,\n        type: data.type,\n        orientation: data.orientation,\n        trustedUrl: $sce.trustAsResourceUrl(data.url),\n        controls: data.controls\n      };\n\n      $timeout(function () {\n        $scope.$apply(function () {\n          vm.files.unshift(file);\n          vm.mainFile = file;\n\n          // Main photo + 24 at mosaic\n          vm.files = vm.files.slice(0, 25);\n\n          // Update UI on new data\n          updateUI();\n\n\n          $timeout(function() {\n            vm.isActiveMainImage = false;\n          }, 18000);\n\n          if (vm.files[0]) {\n            vm.files[0].controls = false;\n          }\n        });\n      });\n    }\n\n    // Crosstab suff --------------------------\n    //\n    // Listen for changes and update $scope\n    crosstab.on('wallNewMedia', function(message) {\n      $log.info(\"crosstab\", message);\n\n      setNewMedia(message.data);\n    });\n    // END - Crosstab suff --------------------------\n\n    $log.info('is crosstab supported', crosstab.supported);\n\n    // Crosstab fallback Sockets\n    if (!crosstab.supported) {\n      var isConnected = false;\n      // Subscribe to Sails server for listen for changes\n      $sails.on(\"connect\", function () {\n        $log.info('Connected to Sails sockets');\n        $sails.post(\"/notify/subscribe\", { roomName: roomName })\n          .then(function (resp) {\n            $log.info('Subscribe OK', resp)\n            isConnected = true;\n          }, function (resp) {\n            $log.error('Subscribe NOT OK', resp)\n          });\n      });\n\n      // TODO(stepanic): refactor this code and remove redundant code\n      $timeout(function () {\n        if (!isConnected) {\n          $log.info('Not connected, try again!');\n          $sails.post(\"/notify/subscribe\", { roomName: roomName })\n            .then(function (resp) {\n              $log.info('Subscribe OK when connected', resp)\n              isConnected = true;\n            }, function (resp) {\n              $log.error('Subscribe NOT OK when connected', resp)\n            });\n        }\n      }, 2000);\n\n      // Watching for updates\n      $sails.on(\"notify-remote-approve\", function (approvedFile) {\n        $log.info('notify-remote-approve', approvedFile);\n\n        setNewMedia(approvedFile);\n      });\n    }\n    // END - Sails.js SOCKET suff --------------------------\n\n    var isRandomAllowed = false;\n    function showRandomMedia() {\n      if (isRandomAllowed) {\n        // var key = Math.round(Math.random() * (vm.files.length - 1));\n        // console.log('randomKey', key);\n        // vm.changeMainFile(key);\n\n        // REFACTORED(stepanic): use queue instead of random\n        // to more change sidebar\n        var first = vm.files[0];\n        vm.files.shift();\n        // Add to end of array\n        if (first) {\n          vm.files.push(first);\n        }\n      }\n    }\n\n    // Random Media every 15 seconds\n    $interval(showRandomMedia, 15000);\n\n    function updateUI() {\n      $scope.windowInnerHeight = $window.innerHeight;\n      $scope.windowInnerWidth = $window.innerWidth;\n      $scope.firstImageWidth = $scope.windowInnerWidth;\n\n      $timeout(function () {\n        // Return to 80% of window width after 15 seconds\n        $scope.firstImageWidth = $scope.windowInnerWidth * 0.8;\n      }, 1500);\n    }\n\n    // Update on load\n    updateUI();\n\n    // updateUI on window resize\n    var w = angular.element($window);\n    w.bind('resize', function () {\n      $scope.$apply(function () {\n        updateUI();\n      });\n    });\n\n    vm.changeMainFile = function (key) {\n      var old = vm.files[0];\n      if (old) {\n        old.controls = false;\n      }\n      vm.files[0] = vm.files[key];\n      if (vm.files[0]) {\n        vm.files[0].controls = true;\n      }\n      if (old) {\n        vm.files[key] = old;\n      }\n      // console.log(old, vm.files, vm.files[key]);\n    }\n\n    // window.bla = vm.files;\n    // window.bla2 = vm.changeMainFile;\n\n    vm.ToggleWallMode = function() {\n      // $state.go('wallDirect', { wallPassword: wallPassword });\n      $state.go('wall');\n    }\n\n    vm.GoToRecord = function() {\n      $state.go('record');\n    }\n\n    vm.isVisibleWallVerifyOption = true;\n    vm.GoToWallVerify = function() {\n      var url = $state.href('wallVerify', {}, {absolute:true});\n      $window.open(url, '_blank');\n    }\n\n\n    /**\n     * Remove media from UI\n     */\n    vm.removeFile = function (file) {\n      console.log('remove', file);\n\n      var index = vm.files.indexOf(file);\n\n      // Remove from list\n      if (index === 0) {\n        if (vm.files && vm.files.length > 1) {\n          // HACK to remove from first position and to release from CSS animation duration\n          // if it is just removed from vm.files it will stay on first place for 3 seconds before delete\n          // bacause of CSS animation duration\n          $timeout(function () {\n            jQuery('li#media-1').trigger({ type:'mousedown', which:1 });\n            vm.files.splice(1, 1);\n          });\n          // set to second place\n          // index = 1;\n        } else {\n          vm.files.splice(0, 1);\n        }\n      } else {\n        if (index > -1) {\n          // remove at index\n          vm.files.splice(index, 1);\n        }\n      }\n\n      // remove from cache if exists\n      var indexInCache = -1;\n      // get fresh data from local storage if some changes are made\n      cachedMedia = localStorageService.get('cachedMedia');\n      for (var i = 0; i < cachedMedia.length; i++) {\n        if (cachedMedia[i] && file) {\n          if (cachedMedia[i].url === file.url) {\n            indexInCache = i;\n          }\n        }\n      }\n\n      // console.log('indexInCache', indexInCache);\n      if (indexInCache > -1) {\n        cachedMedia.splice(indexInCache, 1);\n        updateCachedMedia(cachedMedia);\n      }\n    }\n\n    /**\n     * Handle media from the UI\n     */\n    vm.handleFile = function (file, event) {\n      switch(event.which) {\n        case 1: // this is left click\n        var index = vm.files.indexOf(file);\n            vm.changeMainFile(index);\n            break;\n        case 2: // in case you need some middle click things\n            vm.removeFile(file);\n            break;\n        case 3: // this is right click\n            // right click makes problems\n            //removeFile();\n            break;\n        default:\n            break;\n      }\n\n    }\n\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('WallController', WallController);\n\n  /** @ngInject */\n  function WallController($scope, $state, $stateParams, $timeout, $log, cfpLoadingBar, WallService, ExifService, $sails, $sce, $window, localStorageService) {\n    var vm = this;\n\n    // cache with local storage\n    var updateCachedMedia = function (updatedCachedMedia) {\n      localStorageService.set('cachedMedia', updatedCachedMedia);\n    }\n\n    vm.wallMode = 'watch';\n\n    var cachedMedia = localStorageService.get('cachedMedia');\n    if (!cachedMedia) {\n      cachedMedia = [];\n      updateCachedMedia(cachedMedia);\n    }\n\n    console.log('paramsi', $stateParams);\n\n    vm.files = [];\n    if ($state.current.name === 'wall') {\n      if (cachedMedia && cachedMedia.length > 0) {\n        vm.files = cachedMedia;\n      }\n    }\n    vm.mainFile = null;\n\n    // UI flags for show/hide\n    vm.flags = {};\n\n    vm.isActiveMainImage = false;\n\n    var wallPassword = $stateParams.password || $stateParams.wallPassword || localStorageService.get('wall').password;\n    var wallMasterKey = $stateParams.masterKey;\n\n    if ($state.current.name === 'wallVerify' || $state.current.name === 'wallVerifyRemote') {\n      vm.isVerifyPage = true;\n    }\n\n    // Current authenticated wall\n    var wall = WallService.current();\n\n    if (!wall) {\n      $state.go('home');\n    }\n\n    var id = null;\n    if (wall && wall.id) {\n      id = wall.id;\n    }\n\n    if (!id) {\n      return;\n    }\n\n    if (wall.image) {\n      vm.image = wall.image;\n    }\n\n    var roomName = 'wall' + id;\n\n    // Sails.js SOCKET suff --------------------------\n    //\n    // Unsubscribe on scope destory\n    $scope.$on('$destroy', function () {\n      $sails.delete(\"/notify/unsubscribe\", { roomName: roomName })\n        .then(function (resp) {\n          $log.info('Unubscribe OK', resp)\n        }, function (resp) {\n          $log.error('Unubscribe NOT OK', resp)\n        });\n      $sails.removeAllListeners();\n\n      if (thisChangedTimeout) {\n        $timeout.cancel(thisChangedTimeout);\n      }\n    });\n\n    var isConnected = false;\n    // Subscribe to Sails server for listen for changes\n    $sails.on(\"connect\", function () {\n      $log.info('Connected to Sails from first try');\n      $sails.post(\"/notify/subscribe\", { roomName: roomName })\n        .then(function (resp) {\n          $log.info('Subscribe OK', resp)\n          isConnected = true;\n        }, function (resp) {\n          $log.error('Subscribe NOT OK', resp)\n        });\n    });\n\n    // TODO(stepanic): refactor this code and remove redundant code\n    $timeout(function () {\n      if (!isConnected) {\n        $sails.post(\"/notify/subscribe\", { roomName: roomName })\n          .then(function (resp) {\n            $log.info('Subscribe OK when connected', resp)\n            isConnected = true;\n          }, function (resp) {\n            $log.error('Subscribe NOT OK when connected', resp)\n          });\n      }\n    }, 2000);\n\n    // Listen for changes and update $scope\n    var thisChangedTimeout = null;\n    // Watching for updates\n    $sails.on(\"notify\", function (files) {\n      $log.info('Notify', files);\n      // Update UI on new data\n      updateUI();\n\n      vm.isActiveMainImage = true;\n\n      $timeout(function() {\n        vm.isActiveMainImage = false;\n      }, 5000);\n\n      if (vm.files[0]) {\n        vm.files[0].controls = false;\n      }\n\n      for (var i = 0; i < files.length; i++) {\n        getOrientation(files[i]);\n      }\n    });\n\n    // Watching for updates\n    $sails.on(\"notify-remote-approve\", function (approvedFile) {\n      $log.info('notify-remote-approve', approvedFile);\n\n      // This should not be executed on wallVerifyRemote\n      if ($state.current.name === 'wallVerify') {\n        vm.files.forEach(function(existingFile) {\n          if (existingFile.url === approvedFile.url) {\n            existingFile.checked = true;\n            vm.verifyFile(existingFile);\n            $log.info('Approved file is found and verified', existingFile);\n          }\n        });\n      }\n    });\n    $sails.on(\"notify-remote-disapprove\", function (disapprovedFile) {\n      $log.info('notify-remote-disapprove', disapprovedFile);\n\n      // This should not be executed on wallVerifyRemote\n      if ($state.current.name === 'wallVerify') {\n        vm.files.forEach(function(existingFile) {\n          if (existingFile.url === disapprovedFile.url) {\n            vm.unverifyFile(existingFile);\n            $log.info('Disapproved file is found and unverified', existingFile);\n          }\n        });\n      }\n    });\n    // END - Sails.js SOCKET suff --------------------------\n\n    function getOrientation(file) {\n      ExifService.getOrientation(file.url, function (orientation) {\n        file.orientation = orientation;\n        file.trustedUrl = $sce.trustAsResourceUrl(file.url);\n        $scope.$apply(function () {\n          if ($state.current.name === 'wall') {\n            // Keep DESC order\n            // Add to start of array\n            vm.files.unshift(file);\n            vm.mainFile = file;\n          } else {\n            // Keep ASC order\n            vm.files.push(file);\n            if (vm.files.length === 1) {\n              vm.mainFile = file;\n            }\n          }\n\n          if ($state.current.name === 'wall') {\n            // Main photo + 24 at mosaic\n            vm.files = vm.files.slice(0, 25);\n          }\n\n          // Skip manual check if server has checked it!\n          if ($state.current.name === 'wallVerify') {\n            $log.info('wallVerify', file);\n            if (file.checked === true) {\n              vm.verifyFile(file);\n            }\n          }\n        });\n      });\n    }\n\n    function updateUI() {\n      $scope.windowInnerHeight = $window.innerHeight;\n      $scope.windowInnerWidth = $window.innerWidth;\n      if ($state.current.name === 'wall') {\n        $scope.firstImageWidth = $scope.windowInnerWidth;\n        $timeout(function () {\n          // Return to 80% of window width after 10 seconds\n          $scope.firstImageWidth = $scope.windowInnerWidth * 0.8;\n        }, 10000);\n      }\n    }\n\n    // Update on load\n    updateUI();\n\n    // updateUI on window resize\n    var w = angular.element($window);\n    w.bind('resize', function () {\n      $scope.$apply(function () {\n        updateUI();\n      });\n    });\n\n    vm.changeMainFile = function (key) {\n      var old = vm.files[0];\n      old.controls = false;\n      vm.files[0] = vm.files[key];\n      if (vm.files[0]) {\n        vm.files[0].controls = true;\n      }\n      if (old) {\n        vm.files[key] = old;\n      }\n    }\n\n    vm.removeFile = function (file) {\n      console.log('file to remove', file);\n    }\n\n    vm.ToggleWallMode = function() {\n      // $state.go('wallVerifiedDirect', { wallPassword: wallPassword });\n      $state.go('wallVerified');\n    }\n\n    vm.GoToRecord = function() {\n      $state.go('record');\n    }\n\n    vm.verifyFile = function (file) {\n\n      // Get fresh data if some media is removed to avoid adding removed again\n      cachedMedia = localStorageService.get('cachedMedia');\n      cachedMedia.unshift(file);\n      updateCachedMedia(cachedMedia);\n\n      try {\n        // Send to WallVerifiedController\n        if (crosstab.supported) {\n          crosstab.broadcast('wallNewMedia', file, null);\n        } else {\n          $log.info('Crosstab is not supported, try over sockets, NOTE: password and masterKey are required');\n        }\n      } catch (e) {\n        $log.error(e);\n      }\n\n      // Remote verify\n      if ($state.current.name === 'wallVerifyRemote' && wallPassword && wallMasterKey) {\n        WallService.approveFile(file, wallPassword, wallMasterKey, function (file, error) {\n          if (error) {\n            $log.error('File is not approved, error: ', error);\n          } else {\n            $log.info('File is approved', file);\n          }\n        });\n      }\n\n      // Remove from list\n      var index = vm.files.indexOf(file);\n      if (index > -1) {\n        vm.files.splice(index, 1);\n      }\n\n      // REFACTORED(stepanic): this remove first item\n      // vm.files.shift();\n    }\n\n    vm.unverifyFile = function (file) {\n      // Remove from list\n      var index = vm.files.indexOf(file);\n      if (index > -1) {\n        vm.files.splice(index, 1);\n      }\n\n      // REFACTORED(stepanic): this remove first item\n      // vm.files.shift();\n\n      // Remote unverify\n      if ($state.current.name === 'wallVerifyRemote' && wallPassword && wallMasterKey) {\n        WallService.disapproveFile(file, wallPassword, wallMasterKey, function (file, error) {\n          if (error) {\n            $log.error('File is not disapproved, error: ', error);\n          } else {\n            $log.info('File is disapproved', file);\n          }\n        });\n      }\n    }\n\n    /**\n     * Handle media from the UI\n     */\n    vm.handleFile = function (file, event) {\n      var index = vm.files.indexOf(file);\n\n      switch(event.which) {\n        case 1: // this is left click\n            vm.changeMainFile(index);\n            break;\n        case 2: // in case you need some middle click things\n            // Remove from list\n            if (index === 0) {\n              $scope.$apply(function() {\n              vm.files.shift();\n\n              });\n              // if (vm.files && vm.files.length > 1) {\n                // replace with second\n                // vm.changeMainFile(1);\n                // set to second place\n                // index = 1;\n              // }\n            } else {\n              if (index > -1) {\n                // remove at index\n                vm.files.splice(index, 1);\n              }\n            }\n            break;\n        case 3: // this is right click\n            break;\n        default:\n            break;\n      }\n\n    }\n\n\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .directive('ngMuted', function(){\n      return {\n        priority: 99, // it needs to run after the attributes are interpolated\n        link: function(scope, element, attr) {\n\n          attr.$observe('ngMuted', function(value) {\n            if (value != 'false') {\n              element[0].muted = true;\n            }\n            else{\n              element[0].muted = false;\n            }\n          });\n        }\n      }\n    });\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .directive('ngControls', function(){\n      return {\n        priority: 99, // it needs to run after the attributes are interpolated\n        link: function(scope, element, attr) {\n\n          attr.$observe('ngControls', function(value) {\n            if (value != 'false') {\n              element[0].controls = true;\n            }\n            else{\n              element[0].controls = false;\n            }\n          });\n        }\n      }\n    });\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n      .module('mediaWall')\n      .service('ExifService', ExifService);\n\n  /** @ngInject */\n  function ExifService($log) {\n\n    function getOrientation(imageUrl, callback) {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", imageUrl, true);\n      xhr.responseType = \"arraybuffer\";\n      xhr.onload = function(e) {\n        var arrayBuffer = new Uint8Array(this.response);\n        var exifData = EXIF.readFromBinaryFile(arrayBuffer.buffer);\n\n        $log.info(exifData);\n\n        callback(parseInt(exifData.Orientation || 1, 10));\n      };\n      xhr.send();\n    }\n\n    return {\n      getOrientation: getOrientation\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('ProfileController', ProfileController);\n\n  /** @ngInject */\n  function ProfileController($scope, $state, localStorageService, $timeout, validator) {\n    var vm = this;\n\n    vm.email = '';\n    vm.displayName = '';\n\n    if (localStorageService.get('currentEmail')) {\n      vm.email = localStorageService.get('currentEmail');\n    }\n\n    if (localStorageService.get('currentDisplayName')) {\n      vm.displayName = localStorageService.get('currentDisplayName');\n    }\n\n    vm.saveProfileAndReturnToRecord = function () {\n\n      // Email can be empty\n      if (vm.email && !validator.isValidEmail(vm.email)) {\n        vm.invalidEmail = true;\n\n        $timeout(function() {\n          vm.invalidEmail = false;\n        }, 3000);\n\n        return;\n      }\n\n      console.log(vm.email, vm.displayName);\n\n      // Store\n      localStorageService.set('currentEmail', vm.email ? vm.email : '');\n      localStorageService.set('currentDisplayName', vm.displayName ? vm.displayName : '');\n\n      $state.go('record');\n    };\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('InfoController', InfoController);\n\n  /** @ngInject */\n  function InfoController($scope) {\n    var vm = this;\n\n\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('HomeController', HomeController);\n\n  /** @ngInject */\n  function HomeController($scope, $state, $stateParams, $timeout, $log, cfpLoadingBar, WallService, localStorageService) {\n    var vm = this;\n\n    vm.password = '';\n    vm.passwordIsFocused = true;\n\n    vm.pin = '';\n    vm.pinIsFocused = false;\n    var failedPinTry = '';\n\n    $scope.SetValidPin = function (pin) {\n      vm.pin = pin;\n      vm.wrongPin = false;\n      $log.log(\"PIN: \", pin);\n      if (vm.pin.length === 4) {\n        if (failedPinTry !== vm.pin) {\n          WallService.auth(vm.wall.id, vm.password, vm.pin, function (wall, error) {\n            if (error) {\n              vm.wrongPin = true;\n              failedPinTry = vm.pin;\n            } else {\n              vm.wall = wall;\n\n              // reset cache before next login\n              var cachedMedia = [];\n              localStorageService.set('cachedMedia', cachedMedia);\n\n              $state.go('record');\n            }\n            cfpLoadingBar.complete();\n          });\n        }\n      }\n    }\n\n    vm.GoToRecord = function () {\n      vm.wrongPassword = false;\n      vm.pinIsFocused = false;\n      vm.wall = null;\n      cfpLoadingBar.start();\n\n      vm.password = vm.password.toLowerCase();\n\n      WallService.info(vm.password, function (wall, error) {\n        $log.log(wall, error);\n        if (error) {\n          vm.wrongPassword = true;\n        } else {\n          vm.wall = wall;\n          if (!wall.hasPin) {\n\n            // reset cache before next login\n            var cachedMedia = [];\n            localStorageService.set('cachedMedia', cachedMedia);\n\n            $state.go('record');\n          } else {\n            vm.pinIsFocused = true;\n          }\n        }\n        cfpLoadingBar.complete();\n      });\n    };\n\n    if ($stateParams.wallPassword) {\n      vm.password = $stateParams.wallPassword;\n      vm.GoToRecord();\n    }\n\n    vm.activeTab = 0;\n\n    vm.OpenTab = function (tabId) {\n      if (vm.activeTab === tabId) {\n        vm.activeTab = 0;\n      } else {\n        vm.activeTab = tabId;\n      }\n    }\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .directive('focusMe', function($timeout) {\n      return {\n          link: function ( scope, element, attrs ) {\n              scope.$watch( attrs.focusMe, function ( val ) {\n                  if ( angular.isDefined( val ) && val ) {\n                      $timeout( function () { element[0].focus(); } );\n                  }\n              }, true);\n          }\n      };\n  });\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall.helpers', []);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall.helpers')\n    .service('validator', validator);\n\n  /** @ngInject */\n  function validator() {\n\n    var EMAIL_REGEXP = /^[_a-z0-9]+(\\.[_a-z0-9]+)*(\\+[a-z0-9-]+)?@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,15})$/;\n\n    function isValidEmail(email) {\n      // For empty strings\n      if (!email || email.length === 0) {\n        return false;\n      }\n      return EMAIL_REGEXP.test(email);\n    }\n\n    return {\n      isValidEmail: isValidEmail\n    }\n  }\n\n\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall.helpers')\n    .service('stringHelpers', stringHelpers);\n\n  /** @ngInject */\n  function stringHelpers() {\n\n    function transliterateCyrillicToLatin(word){\n        var answer = \"\"\n          , a = {};\n\n       a[\"Ё\"]=\"YO\";a[\"Й\"]=\"I\";a[\"Ц\"]=\"TS\";a[\"У\"]=\"U\";a[\"К\"]=\"K\";a[\"Е\"]=\"E\";a[\"Н\"]=\"N\";a[\"Г\"]=\"G\";a[\"Ш\"]=\"SH\";a[\"Щ\"]=\"SCH\";a[\"З\"]=\"Z\";a[\"Х\"]=\"H\";a[\"Ъ\"]=\"'\";\n       a[\"ё\"]=\"yo\";a[\"й\"]=\"i\";a[\"ц\"]=\"ts\";a[\"у\"]=\"u\";a[\"к\"]=\"k\";a[\"е\"]=\"e\";a[\"н\"]=\"n\";a[\"г\"]=\"g\";a[\"ш\"]=\"sh\";a[\"щ\"]=\"sch\";a[\"з\"]=\"z\";a[\"х\"]=\"h\";a[\"ъ\"]=\"'\";\n       a[\"Ф\"]=\"F\";a[\"Ы\"]=\"I\";a[\"В\"]=\"V\";a[\"А\"]=\"a\";a[\"П\"]=\"P\";a[\"Р\"]=\"R\";a[\"О\"]=\"O\";a[\"Л\"]=\"L\";a[\"Д\"]=\"D\";a[\"Ж\"]=\"ZH\";a[\"Э\"]=\"E\";\n       a[\"ф\"]=\"f\";a[\"ы\"]=\"i\";a[\"в\"]=\"v\";a[\"а\"]=\"a\";a[\"п\"]=\"p\";a[\"р\"]=\"r\";a[\"о\"]=\"o\";a[\"л\"]=\"l\";a[\"д\"]=\"d\";a[\"ж\"]=\"zh\";a[\"э\"]=\"e\";\n       a[\"Я\"]=\"Ya\";a[\"Ч\"]=\"CH\";a[\"С\"]=\"S\";a[\"М\"]=\"M\";a[\"И\"]=\"I\";a[\"Т\"]=\"T\";a[\"Ь\"]=\"'\";a[\"Б\"]=\"B\";a[\"Ю\"]=\"YU\";\n       a[\"я\"]=\"ya\";a[\"ч\"]=\"ch\";a[\"с\"]=\"s\";a[\"м\"]=\"m\";a[\"и\"]=\"i\";a[\"т\"]=\"t\";a[\"ь\"]=\"'\";a[\"б\"]=\"b\";a[\"ю\"]=\"yu\";\n\n       for (var i in word){\n         if (word.hasOwnProperty(i)) {\n           if (a[word[i]] === undefined){\n             answer += word[i];\n           } else {\n             answer += a[word[i]];\n           }\n         }\n       }\n       return answer;\n    }\n\n    function replaceDiacritics (str) {\n\n      var defaultDiacriticsRemovalMap = [\n        {'base':'A', 'letters':/[\\u0041\\u24B6\\uFF21\\u00C0\\u00C1\\u00C2\\u1EA6\\u1EA4\\u1EAA\\u1EA8\\u00C3\\u0100\\u0102\\u1EB0\\u1EAE\\u1EB4\\u1EB2\\u0226\\u01E0\\u00C4\\u01DE\\u1EA2\\u00C5\\u01FA\\u01CD\\u0200\\u0202\\u1EA0\\u1EAC\\u1EB6\\u1E00\\u0104\\u023A\\u2C6F]/g},\n        {'base':'AA','letters':/[\\uA732]/g},\n        {'base':'AE','letters':/[\\u00C6\\u01FC\\u01E2]/g},\n        {'base':'AO','letters':/[\\uA734]/g},\n        {'base':'AU','letters':/[\\uA736]/g},\n        {'base':'AV','letters':/[\\uA738\\uA73A]/g},\n        {'base':'AY','letters':/[\\uA73C]/g},\n        {'base':'B', 'letters':/[\\u0042\\u24B7\\uFF22\\u1E02\\u1E04\\u1E06\\u0243\\u0182\\u0181]/g},\n        {'base':'C', 'letters':/[\\u0043\\u24B8\\uFF23\\u0106\\u0108\\u010A\\u010C\\u00C7\\u1E08\\u0187\\u023B\\uA73E]/g},\n        {'base':'D', 'letters':/[\\u0044\\u24B9\\uFF24\\u1E0A\\u010E\\u1E0C\\u1E10\\u1E12\\u1E0E\\u0110\\u018B\\u018A\\u0189\\uA779]/g},\n        {'base':'DZ','letters':/[\\u01F1\\u01C4]/g},\n        {'base':'Dz','letters':/[\\u01F2\\u01C5]/g},\n        {'base':'E', 'letters':/[\\u0045\\u24BA\\uFF25\\u00C8\\u00C9\\u00CA\\u1EC0\\u1EBE\\u1EC4\\u1EC2\\u1EBC\\u0112\\u1E14\\u1E16\\u0114\\u0116\\u00CB\\u1EBA\\u011A\\u0204\\u0206\\u1EB8\\u1EC6\\u0228\\u1E1C\\u0118\\u1E18\\u1E1A\\u0190\\u018E]/g},\n        {'base':'F', 'letters':/[\\u0046\\u24BB\\uFF26\\u1E1E\\u0191\\uA77B]/g},\n        {'base':'G', 'letters':/[\\u0047\\u24BC\\uFF27\\u01F4\\u011C\\u1E20\\u011E\\u0120\\u01E6\\u0122\\u01E4\\u0193\\uA7A0\\uA77D\\uA77E]/g},\n        {'base':'H', 'letters':/[\\u0048\\u24BD\\uFF28\\u0124\\u1E22\\u1E26\\u021E\\u1E24\\u1E28\\u1E2A\\u0126\\u2C67\\u2C75\\uA78D]/g},\n        {'base':'I', 'letters':/[\\u0049\\u24BE\\uFF29\\u00CC\\u00CD\\u00CE\\u0128\\u012A\\u012C\\u0130\\u00CF\\u1E2E\\u1EC8\\u01CF\\u0208\\u020A\\u1ECA\\u012E\\u1E2C\\u0197]/g},\n        {'base':'J', 'letters':/[\\u004A\\u24BF\\uFF2A\\u0134\\u0248]/g},\n        {'base':'K', 'letters':/[\\u004B\\u24C0\\uFF2B\\u1E30\\u01E8\\u1E32\\u0136\\u1E34\\u0198\\u2C69\\uA740\\uA742\\uA744\\uA7A2]/g},\n        {'base':'L', 'letters':/[\\u004C\\u24C1\\uFF2C\\u013F\\u0139\\u013D\\u1E36\\u1E38\\u013B\\u1E3C\\u1E3A\\u0141\\u023D\\u2C62\\u2C60\\uA748\\uA746\\uA780]/g},\n        {'base':'LJ','letters':/[\\u01C7]/g},\n        {'base':'Lj','letters':/[\\u01C8]/g},\n        {'base':'M', 'letters':/[\\u004D\\u24C2\\uFF2D\\u1E3E\\u1E40\\u1E42\\u2C6E\\u019C]/g},\n        {'base':'N', 'letters':/[\\u004E\\u24C3\\uFF2E\\u01F8\\u0143\\u00D1\\u1E44\\u0147\\u1E46\\u0145\\u1E4A\\u1E48\\u0220\\u019D\\uA790\\uA7A4]/g},\n        {'base':'NJ','letters':/[\\u01CA]/g},\n        {'base':'Nj','letters':/[\\u01CB]/g},\n        {'base':'O', 'letters':/[\\u004F\\u24C4\\uFF2F\\u00D2\\u00D3\\u00D4\\u1ED2\\u1ED0\\u1ED6\\u1ED4\\u00D5\\u1E4C\\u022C\\u1E4E\\u014C\\u1E50\\u1E52\\u014E\\u022E\\u0230\\u00D6\\u022A\\u1ECE\\u0150\\u01D1\\u020C\\u020E\\u01A0\\u1EDC\\u1EDA\\u1EE0\\u1EDE\\u1EE2\\u1ECC\\u1ED8\\u01EA\\u01EC\\u00D8\\u01FE\\u0186\\u019F\\uA74A\\uA74C]/g},\n        {'base':'OI','letters':/[\\u01A2]/g},\n        {'base':'OO','letters':/[\\uA74E]/g},\n        {'base':'OU','letters':/[\\u0222]/g},\n        {'base':'P', 'letters':/[\\u0050\\u24C5\\uFF30\\u1E54\\u1E56\\u01A4\\u2C63\\uA750\\uA752\\uA754]/g},\n        {'base':'Q', 'letters':/[\\u0051\\u24C6\\uFF31\\uA756\\uA758\\u024A]/g},\n        {'base':'R', 'letters':/[\\u0052\\u24C7\\uFF32\\u0154\\u1E58\\u0158\\u0210\\u0212\\u1E5A\\u1E5C\\u0156\\u1E5E\\u024C\\u2C64\\uA75A\\uA7A6\\uA782]/g},\n        {'base':'S', 'letters':/[\\u0053\\u24C8\\uFF33\\u1E9E\\u015A\\u1E64\\u015C\\u1E60\\u0160\\u1E66\\u1E62\\u1E68\\u0218\\u015E\\u2C7E\\uA7A8\\uA784]/g},\n        {'base':'T', 'letters':/[\\u0054\\u24C9\\uFF34\\u1E6A\\u0164\\u1E6C\\u021A\\u0162\\u1E70\\u1E6E\\u0166\\u01AC\\u01AE\\u023E\\uA786]/g},\n        {'base':'TZ','letters':/[\\uA728]/g},\n        {'base':'U', 'letters':/[\\u0055\\u24CA\\uFF35\\u00D9\\u00DA\\u00DB\\u0168\\u1E78\\u016A\\u1E7A\\u016C\\u00DC\\u01DB\\u01D7\\u01D5\\u01D9\\u1EE6\\u016E\\u0170\\u01D3\\u0214\\u0216\\u01AF\\u1EEA\\u1EE8\\u1EEE\\u1EEC\\u1EF0\\u1EE4\\u1E72\\u0172\\u1E76\\u1E74\\u0244]/g},\n        {'base':'V', 'letters':/[\\u0056\\u24CB\\uFF36\\u1E7C\\u1E7E\\u01B2\\uA75E\\u0245]/g},\n        {'base':'VY','letters':/[\\uA760]/g},\n        {'base':'W', 'letters':/[\\u0057\\u24CC\\uFF37\\u1E80\\u1E82\\u0174\\u1E86\\u1E84\\u1E88\\u2C72]/g},\n        {'base':'X', 'letters':/[\\u0058\\u24CD\\uFF38\\u1E8A\\u1E8C]/g},\n        {'base':'Y', 'letters':/[\\u0059\\u24CE\\uFF39\\u1EF2\\u00DD\\u0176\\u1EF8\\u0232\\u1E8E\\u0178\\u1EF6\\u1EF4\\u01B3\\u024E\\u1EFE]/g},\n        {'base':'Z', 'letters':/[\\u005A\\u24CF\\uFF3A\\u0179\\u1E90\\u017B\\u017D\\u1E92\\u1E94\\u01B5\\u0224\\u2C7F\\u2C6B\\uA762]/g},\n        {'base':'a', 'letters':/[\\u0061\\u24D0\\uFF41\\u1E9A\\u00E0\\u00E1\\u00E2\\u1EA7\\u1EA5\\u1EAB\\u1EA9\\u00E3\\u0101\\u0103\\u1EB1\\u1EAF\\u1EB5\\u1EB3\\u0227\\u01E1\\u00E4\\u01DF\\u1EA3\\u00E5\\u01FB\\u01CE\\u0201\\u0203\\u1EA1\\u1EAD\\u1EB7\\u1E01\\u0105\\u2C65\\u0250]/g},\n        {'base':'aa','letters':/[\\uA733]/g},\n        {'base':'ae','letters':/[\\u00E6\\u01FD\\u01E3]/g},\n        {'base':'ao','letters':/[\\uA735]/g},\n        {'base':'au','letters':/[\\uA737]/g},\n        {'base':'av','letters':/[\\uA739\\uA73B]/g},\n        {'base':'ay','letters':/[\\uA73D]/g},\n        {'base':'b', 'letters':/[\\u0062\\u24D1\\uFF42\\u1E03\\u1E05\\u1E07\\u0180\\u0183\\u0253]/g},\n        {'base':'c', 'letters':/[\\u0063\\u24D2\\uFF43\\u0107\\u0109\\u010B\\u010D\\u00E7\\u1E09\\u0188\\u023C\\uA73F\\u2184]/g},\n        {'base':'d', 'letters':/[\\u0064\\u24D3\\uFF44\\u1E0B\\u010F\\u1E0D\\u1E11\\u1E13\\u1E0F\\u0111\\u018C\\u0256\\u0257\\uA77A]/g},\n        {'base':'dz','letters':/[\\u01F3\\u01C6]/g},\n        {'base':'e', 'letters':/[\\u0065\\u24D4\\uFF45\\u00E8\\u00E9\\u00EA\\u1EC1\\u1EBF\\u1EC5\\u1EC3\\u1EBD\\u0113\\u1E15\\u1E17\\u0115\\u0117\\u00EB\\u1EBB\\u011B\\u0205\\u0207\\u1EB9\\u1EC7\\u0229\\u1E1D\\u0119\\u1E19\\u1E1B\\u0247\\u025B\\u01DD]/g},\n        {'base':'f', 'letters':/[\\u0066\\u24D5\\uFF46\\u1E1F\\u0192\\uA77C]/g},\n        {'base':'g', 'letters':/[\\u0067\\u24D6\\uFF47\\u01F5\\u011D\\u1E21\\u011F\\u0121\\u01E7\\u0123\\u01E5\\u0260\\uA7A1\\u1D79\\uA77F]/g},\n        {'base':'h', 'letters':/[\\u0068\\u24D7\\uFF48\\u0125\\u1E23\\u1E27\\u021F\\u1E25\\u1E29\\u1E2B\\u1E96\\u0127\\u2C68\\u2C76\\u0265]/g},\n        {'base':'hv','letters':/[\\u0195]/g},\n        {'base':'i', 'letters':/[\\u0069\\u24D8\\uFF49\\u00EC\\u00ED\\u00EE\\u0129\\u012B\\u012D\\u00EF\\u1E2F\\u1EC9\\u01D0\\u0209\\u020B\\u1ECB\\u012F\\u1E2D\\u0268\\u0131]/g},\n        {'base':'j', 'letters':/[\\u006A\\u24D9\\uFF4A\\u0135\\u01F0\\u0249]/g},\n        {'base':'k', 'letters':/[\\u006B\\u24DA\\uFF4B\\u1E31\\u01E9\\u1E33\\u0137\\u1E35\\u0199\\u2C6A\\uA741\\uA743\\uA745\\uA7A3]/g},\n        {'base':'l', 'letters':/[\\u006C\\u24DB\\uFF4C\\u0140\\u013A\\u013E\\u1E37\\u1E39\\u013C\\u1E3D\\u1E3B\\u017F\\u0142\\u019A\\u026B\\u2C61\\uA749\\uA781\\uA747]/g},\n        {'base':'lj','letters':/[\\u01C9]/g},\n        {'base':'m', 'letters':/[\\u006D\\u24DC\\uFF4D\\u1E3F\\u1E41\\u1E43\\u0271\\u026F]/g},\n        {'base':'n', 'letters':/[\\u006E\\u24DD\\uFF4E\\u01F9\\u0144\\u00F1\\u1E45\\u0148\\u1E47\\u0146\\u1E4B\\u1E49\\u019E\\u0272\\u0149\\uA791\\uA7A5]/g},\n        {'base':'nj','letters':/[\\u01CC]/g},\n        {'base':'o', 'letters':/[\\u006F\\u24DE\\uFF4F\\u00F2\\u00F3\\u00F4\\u1ED3\\u1ED1\\u1ED7\\u1ED5\\u00F5\\u1E4D\\u022D\\u1E4F\\u014D\\u1E51\\u1E53\\u014F\\u022F\\u0231\\u00F6\\u022B\\u1ECF\\u0151\\u01D2\\u020D\\u020F\\u01A1\\u1EDD\\u1EDB\\u1EE1\\u1EDF\\u1EE3\\u1ECD\\u1ED9\\u01EB\\u01ED\\u00F8\\u01FF\\u0254\\uA74B\\uA74D\\u0275]/g},\n        {'base':'oi','letters':/[\\u01A3]/g},\n        {'base':'ou','letters':/[\\u0223]/g},\n        {'base':'oo','letters':/[\\uA74F]/g},\n        {'base':'p','letters':/[\\u0070\\u24DF\\uFF50\\u1E55\\u1E57\\u01A5\\u1D7D\\uA751\\uA753\\uA755]/g},\n        {'base':'q','letters':/[\\u0071\\u24E0\\uFF51\\u024B\\uA757\\uA759]/g},\n        {'base':'r','letters':/[\\u0072\\u24E1\\uFF52\\u0155\\u1E59\\u0159\\u0211\\u0213\\u1E5B\\u1E5D\\u0157\\u1E5F\\u024D\\u027D\\uA75B\\uA7A7\\uA783]/g},\n        {'base':'s','letters':/[\\u0073\\u24E2\\uFF53\\u00DF\\u015B\\u1E65\\u015D\\u1E61\\u0161\\u1E67\\u1E63\\u1E69\\u0219\\u015F\\u023F\\uA7A9\\uA785\\u1E9B]/g},\n        {'base':'t','letters':/[\\u0074\\u24E3\\uFF54\\u1E6B\\u1E97\\u0165\\u1E6D\\u021B\\u0163\\u1E71\\u1E6F\\u0167\\u01AD\\u0288\\u2C66\\uA787]/g},\n        {'base':'tz','letters':/[\\uA729]/g},\n        {'base':'u','letters':/[\\u0075\\u24E4\\uFF55\\u00F9\\u00FA\\u00FB\\u0169\\u1E79\\u016B\\u1E7B\\u016D\\u00FC\\u01DC\\u01D8\\u01D6\\u01DA\\u1EE7\\u016F\\u0171\\u01D4\\u0215\\u0217\\u01B0\\u1EEB\\u1EE9\\u1EEF\\u1EED\\u1EF1\\u1EE5\\u1E73\\u0173\\u1E77\\u1E75\\u0289]/g},\n        {'base':'v','letters':/[\\u0076\\u24E5\\uFF56\\u1E7D\\u1E7F\\u028B\\uA75F\\u028C]/g},\n        {'base':'vy','letters':/[\\uA761]/g},\n        {'base':'w','letters':/[\\u0077\\u24E6\\uFF57\\u1E81\\u1E83\\u0175\\u1E87\\u1E85\\u1E98\\u1E89\\u2C73]/g},\n        {'base':'x','letters':/[\\u0078\\u24E7\\uFF58\\u1E8B\\u1E8D]/g},\n        {'base':'y','letters':/[\\u0079\\u24E8\\uFF59\\u1EF3\\u00FD\\u0177\\u1EF9\\u0233\\u1E8F\\u00FF\\u1EF7\\u1E99\\u1EF5\\u01B4\\u024F\\u1EFF]/g},\n        {'base':'z','letters':/[\\u007A\\u24E9\\uFF5A\\u017A\\u1E91\\u017C\\u017E\\u1E93\\u1E95\\u01B6\\u0225\\u0240\\u2C6C\\uA763]/g}\n      ];\n\n      for(var i=0; i<defaultDiacriticsRemovalMap.length; i++) {\n        str = str.replace(defaultDiacriticsRemovalMap[i].letters, defaultDiacriticsRemovalMap[i].base);\n      }\n\n      return str;\n\n    }\n\n    function replaceSpacesWithUnderscores(str) {\n      return str.replace(/\\ /g, '_');\n    }\n\n    function keepOnlyAlfanumericsDotsMonkeysUnderscoresAndDashes(str) {\n      return str.replace(/[^a-z0-9\\.@_\\-]/ig, '');\n    }\n\n    function unicodeToAscii(str) {\n      str = transliterateCyrillicToLatin(str);\n      str = replaceDiacritics(str);\n      return str;\n    }\n\n    function toSafeUriString(str) {\n      str = unicodeToAscii(str);\n      str = replaceSpacesWithUnderscores(str);\n      str = keepOnlyAlfanumericsDotsMonkeysUnderscoresAndDashes(str);\n      return str;\n    }\n\n\n    return {\n      toSafeUriString: toSafeUriString\n    }\n  }\n\n\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall.helpers')\n    .filter('filename', filename);\n\n  /** @ngInject */\n  function filename() {\n    return function (input, part) {\n      part = part || 'first';\n      input = input || '';\n      var out = \"\";\n\n      // TODO(stepanic): refactor with better\n\n      var urlParts = input.split('/');\n      var filenameParts = urlParts[urlParts.length - 1].split('-');\n\n      if (part === 'first') {\n        var displayName = filenameParts[0].replace(/_/g, ' ');\n        if (displayName.match(/^[a-zA-Z]/)) {\n          if (displayName.match(/@/)) {\n            out = displayName;\n          } else {\n            out = '@' + displayName;\n          }\n        }\n      } else {\n        out = input;\n      }\n\n      return out;\n    };\n  }\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n      .module('mediaWall')\n      .service('WallService', WallService);\n\n  /** @ngInject */\n  function WallService(ENV, $http, localStorageService) {\n\n    var serverBase = ENV.backendUrl;\n\n    function current () {\n      var wall = localStorageService.get('wall');\n      return wall;\n    }\n\n    function info (password, callback) {\n      var requestUrl = serverBase + '/wall/info';\n\n      var fd = new FormData();\n      fd.append('password', password);\n\n      $http.post(requestUrl, fd, {\n        transformRequest: angular.identity,\n        headers: {\n          'Content-Type': undefined\n        }\n      })\n      .success(function (response) {\n        if (!response || !response.data) {\n          return callback(null, {\n            code: 100404\n          });\n        }\n        var wall = response.data;\n        // save in local storage\n        localStorageService.set('wall', wall);\n        // return data as callback\n        callback(wall);\n      })\n      .error(function (response) {\n        callback(null, {\n          code: 100404\n        });\n      });\n    }\n\n    function auth (id, password, pin, callback) {\n      var requestUrl = serverBase + '/wall/auth';\n\n      var fd = new FormData();\n      fd.append('id', id);\n      fd.append('password', password);\n      fd.append('pin', pin);\n\n      $http.post(requestUrl, fd, {\n        transformRequest: angular.identity,\n        headers: {\n          'Content-Type': undefined\n        }\n      })\n      .success(function (response) {\n        if (!response || !response.data) {\n          return callback(null, {\n            code: 100404\n          });\n        }\n        var wall = response.data;\n        // save in local storage\n        localStorageService.set('wall', wall);\n        // return data as callback\n        callback(wall);\n      })\n      .error(function (response) {\n        callback(null, {\n          code: 100404\n        });\n      });\n    }\n\n    function approveFileApi (file, password, masterKey, callback, disapprove) {\n      var requestUrl = serverBase + '/wall/approve/file';\n\n      var params = {\n        file: file,\n        password: password,\n        masterKey: masterKey\n      };\n\n      if (disapprove) {\n        params.disapprove = true;\n      }\n\n      $http.post(requestUrl, params)\n      .success(function (response) {\n        callback(response.data);\n      })\n      .error(function (response, status) {\n        callback(null, {\n          status: status,\n          summary: response.summary\n        });\n      });\n    }\n\n    function approveFile (file, password, masterKey, callback) {\n      approveFileApi(file, password, masterKey, callback);\n    }\n\n    function disapproveFile (file, password, masterKey, callback) {\n      approveFileApi(file, password, masterKey, callback, true);\n    }\n\n    return {\n      current: current,\n      info: info,\n      auth: auth,\n      approveFile: approveFile,\n      disapproveFile: disapproveFile\n    }\n  }\n\n\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n      .module('mediaWall')\n      .service('UploadService', UploadService);\n\n  /** @ngInject */\n  function UploadService(ENV, $http, localStorageService, $log, stringHelpers) {\n\n    var serverBase = ENV.backendUrl;\n\n    function getFilePrefix() {\n      var prefix = '';\n\n      var currentEmail = localStorageService.get('currentEmail');\n      var currentDisplayName = localStorageService.get('currentDisplayName');\n\n      if (currentDisplayName && !currentDisplayName.startsWith('.')) {\n        prefix += currentDisplayName + \"-\";\n      }\n\n      if (currentEmail && !currentEmail.startsWith('.')) {\n        prefix += currentEmail + \"-\";\n      }\n\n      return stringHelpers.toSafeUriString(prefix);\n    }\n\n    function uploadFiles(files, callback, uploadProgress, wallMasterKey) {\n      var uploadUrl = serverBase + '/upload';\n\n      var fd = new FormData();\n\n      var wall = localStorageService.get('wall');\n      fd.append('wall-id', wall.id);\n      fd.append('wall-password', wall.password);\n      fd.append('wall-pin', wall.pin);\n      if (wallMasterKey) {\n        fd.append('wall-master-key', wallMasterKey);\n      }\n      fd.append('prefix', getFilePrefix());\n\n      for (var i = 0; i < files.length; i++) {\n        fd.append('files', files[i]);\n      }\n\n      $log.info('Upload started');\n\n      var xhr = new XMLHttpRequest();\n\n      xhr.upload.addEventListener(\"progress\", uploadProgress, false);\n\n      xhr.addEventListener(\"readystatechange\", function (e) {\n        // upload completed\n        if (this.readyState === 4) {\n          $log.info('Success: Upload done', e);\n\n          var response = e.target.response;\n\n          if (response) {\n            try {\n              response=JSON.parse(response);\n            } catch (e) {\n              $log.error('JSON.parse()', e);\n            }\n          }\n\n          callback(false, response);\n        }\n\n        // xhr = null;\n      });\n\n      xhr.addEventListener(\"error\", function (e) {\n        $log.error('Error: Upload failed', e);\n        callback(true);\n      });\n      //xhr.addEventListener(\"abort\", uploadCanceled, false);\n      xhr.open(\"POST\", uploadUrl);\n\n      // send the form data to the server\n      xhr.send(fd);\n\n    }\n\n    return {\n      files: uploadFiles\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($log, $rootScope, $window) {\n\n    // TODO(stepanic): try to refactor with better Angular way maybe with $state\n    // slideshow is required to make overflow: hidden on <body> tag\n    if ($window.location.pathname === '/gledaj' || $window.location.pathname === '/gledaj/provjereno') {\n      $rootScope.slideshow = 'true';\n    } else {\n      $rootScope.slideshow = 'false';\n    }\n\n    $log.debug('runBlock end');\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/',\n        templateUrl: 'app/home/home.html',\n        controller: 'HomeController',\n        controllerAs: 'home'\n      })\n      .state('info', {\n        url: '/info',\n        templateUrl: 'app/info/info.html',\n        controller: 'InfoController',\n        controllerAs: 'info'\n      })\n      .state('profile', {\n        url: '/profil',\n        templateUrl: 'app/profile/profile.html',\n        controller: 'ProfileController',\n        controllerAs: 'profile'\n      })\n      .state('record', {\n        url: '/fotkaj',\n        templateUrl: 'app/record/record.html',\n        controller: 'RecordController',\n        controllerAs: 'record'\n      })\n      .state('recordWithMasterKey', {\n        url: '/fotkaj/:masterKey',\n        templateUrl: 'app/record/record.html',\n        controller: 'RecordController',\n        controllerAs: 'record'\n      })\n      .state('gallery', {\n        url: '/pregledaj',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallController',\n        controllerAs: 'wall'\n      })\n      .state('wallVerify', {\n        url: '/gledaj/provjeri',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallController',\n        controllerAs: 'wall'\n      })\n      .state('wallVerifyRemote', {\n        url: '/gledaj/provjeri/:password/:masterKey',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallController',\n        controllerAs: 'wall'\n      })\n      .state('wallVerified', {\n        url: '/gledaj/provjereno',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallVerifiedController',\n        controllerAs: 'wall'\n      })\n      .state('wallVerifiedDirect', {\n        url: '/gledaj/provjereno/:wallPassword',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallVerifiedController',\n        controllerAs: 'wall'\n      })\n      .state('wall', {\n        url: '/gledaj',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallController',\n        controllerAs: 'wall'\n      })\n        .state('wallDirect', {\n          url: '/gledaj/:wallPassword',\n          templateUrl: 'app/wall/wall.html',\n          controller: 'WallController',\n          controllerAs: 'wall'\n        })\n      .state('directOpenWallFromUrlParam', {\n        url: '/:wallPassword',\n        templateUrl: 'app/home/home.html',\n        controller: 'HomeController',\n        controllerAs: 'home'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n/* global, moment:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .constant('publicName', 'Vjenčanje.online');\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .config(function ($sailsProvider, ENV) {\n      $sailsProvider.url = ENV.backendUrl;\n    })\n    .config(function (logExProvider, ENV) {\n      logExProvider.enableLogging(ENV.enableLogging);\n    })\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, $locationProvider, localStorageServiceProvider, cfpLoadingBarProvider) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    // HTML5 mode\n    $locationProvider.html5Mode(true).hashPrefix('!');\n\n    // Local Storage\n    localStorageServiceProvider\n      .setPrefix('mediaWall');\n\n    cfpLoadingBarProvider.autoIncrement = false;\n  }\n\n})();\n\nangular.module(\"mediaWall\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/home/home.html\",\"<div layout=\\\"row\\\" layout-fill=\\\"\\\" layout-align=\\\"center center\\\" id=\\\"home-simple\\\" device-detector=\\\"\\\"><h1><strong onclick=\\\"document.getElementById(\\'input-password\\').focus()\\\">Eventy</strong>.online</h1><h2>Nemojte propustiti niti jedan trenutak!</h2><form ng-submit=\\\"home.GoToRecord()\\\"><div layout=\\\"column\\\" layout-align=\\\"center\\\" ng-cloak=\\\"\\\" class=\\\"md-inline-form\\\"><p ng-show=\\\"home.wrongPassword\\\" class=\\\"error\\\">Neispravna lozinka, pokušajte ponovno!</p><p ng-show=\\\"home.wrongPin\\\" class=\\\"error\\\">Neispravan PIN, pokušajte ponovno!</p><md-input-container><label>Lozinka</label> <input type=\\\"text\\\" id=\\\"input-password\\\" focus-me=\\\"home.passwordIsFocused\\\" ng-model=\\\"home.password\\\"></md-input-container><md-input-container ng-show=\\\"home.wall.hasPin\\\"><label>Pin</label> <input type=\\\"number\\\" id=\\\"input-pin-simple\\\" focus-me=\\\"home.pinIsFocused\\\" pattern=\\\"[0-9]*\\\" onkeyup=\\\"document.getElementById(\\'input-pin-simple\\').value = document.getElementById(\\'input-pin-simple\\').value.slice(0,4); angular.element(this).scope().SetValidPin(document.getElementById(\\'input-pin-simple\\').value)\\\" onkeydown=\\\"if (event.keyCode === 13) { return false; }\\\"></md-input-container><md-button class=\\\"md-raised\\\"><strong>Ulazak na event</strong></md-button></div></form></div><div layout=\\\"row\\\" layout-fill=\\\"\\\" layout-align=\\\"center center\\\" id=\\\"home\\\" device-detector=\\\"\\\"><div layout=\\\"column\\\" class=\\\"container\\\"><div layout-align=\\\"center center\\\" class=\\\"title\\\" flex=\\\"\\\"><h1 class=\\\"md-display-3 logo\\\"><span onclick=\\\"document.getElementById(\\'input-password\\').focus()\\\"><b>EVENTY</b>.online</span></h1><h2 class=\\\"md-display-1\\\">Nemojte propustiti niti jedan trenutak!</h2><p class=\\\"process-image\\\" hide-md=\\\"\\\" hide-sm=\\\"\\\" hide-xs=\\\"\\\"></p><form ng-submit=\\\"home.GoToRecord()\\\"><div layout=\\\"column\\\" layout-align=\\\"center\\\" ng-cloak=\\\"\\\" class=\\\"md-inline-form\\\"><p ng-show=\\\"home.wrongPassword\\\" class=\\\"error\\\">Neispravna lozinka, pokušajte ponovno!</p><p ng-show=\\\"home.wrongPin\\\" class=\\\"error\\\">Neispravan PIN, pokušajte ponovno!</p><md-input-container flex=\\\"\\\"><label>Lozinka</label> <input type=\\\"text\\\" id=\\\"input-password\\\" focus-me=\\\"home.passwordIsFocused\\\" ng-model=\\\"home.password\\\"></md-input-container><md-input-container ng-show=\\\"home.wall.hasPin\\\" flex=\\\"\\\"><label>Pin</label> <input type=\\\"number\\\" id=\\\"input-pin\\\" focus-me=\\\"home.pinIsFocused\\\" pattern=\\\"[0-9]*\\\" onkeyup=\\\"document.getElementById(\\'input-pin\\').value = document.getElementById(\\'input-pin\\').value.slice(0,4); angular.element(this).scope().SetValidPin(document.getElementById(\\'input-pin\\').value)\\\" onkeydown=\\\"if (event.keyCode === 13) { return false; }\\\"></md-input-container><md-button class=\\\"md-raised\\\"><strong>Ulazak na event</strong></md-button></div></form></div></div></div>\");\n$templateCache.put(\"app/info/info.html\",\"INFO\");\n$templateCache.put(\"app/profile/profile.html\",\"<div layout=\\\"column\\\" layout-fill=\\\"\\\" layout-align=\\\"center center\\\" id=\\\"profile\\\"><div layout=\\\"column\\\" class=\\\"container\\\"><div layout-align=\\\"center\\\" flex=\\\"\\\"><h1 class=\\\"logo\\\"><span onclick=\\\"document.getElementById(\\'input-email\\').focus()\\\"><b>EVENTY</b>.online</span></h1><form class=\\\"profile-form\\\" ng-submit=\\\"profile.saveProfileAndReturnToRecord()\\\"><div layout=\\\"column\\\" layout-align=\\\"center\\\" ng-cloak=\\\"\\\" class=\\\"md-inline-form\\\"><div class=\\\"fields\\\"><p ng-show=\\\"profile.invalidEmail\\\" class=\\\"error\\\">Neispravna email adresa, pokušajte ponovno!</p><p ng-show=\\\"profile.invalidName\\\" class=\\\"error\\\">Neispravno ime i prezime, pokušajte ponovno!</p><md-input-container ng-show=\\\"false\\\" flex=\\\"\\\"><label>Email adresa</label> <input type=\\\"text\\\" id=\\\"input-email\\\" focus-me=\\\"profile.emailIsFocused\\\" ng-model=\\\"profile.email\\\"></md-input-container><div ng-show=\\\"false\\\" class=\\\"helper-note\\\">* Ukoliko želite primati obavijesti kako fotke i video zapisi stižu, molim Vas upišite svoju email adresu.</div><md-input-container flex=\\\"\\\"><label>Ime i prezime</label> <input type=\\\"text\\\" id=\\\"input-display-name\\\" ng-model=\\\"profile.displayName\\\" focus-me=\\\"profile.nameIsFocused\\\"></md-input-container><div class=\\\"helper-note\\\">* Super je znati tko je poslao fotku ili video zapis pa Vas molimo da upišete svoje ime i prezime.</div></div><md-button class=\\\"md-raised\\\"><strong>Spremi i fotkaj</strong></md-button></div></form></div></div></div>\");\n$templateCache.put(\"app/record/record.html\",\"<div layout=\\\"column\\\" layout-fill=\\\"\\\" layout-align=\\\"center center\\\" id=\\\"record\\\"><div class=\\\"progress-counter\\\" ng-show=\\\"showProgressBar\\\">{{progressCounter | number:0}}%</div><div class=\\\"wall-description-mobile\\\"><div class=\\\"cname\\\">{{wall.password}}</div><div class=\\\"watch\\\"><button ng-click=\\\"record.GoToWall()\\\">&nbsp;</button></div><div class=\\\"gallery\\\"><button ng-click=\\\"record.GoToGallery()\\\">&nbsp;</button></div></div><div hide-gt-md=\\\"\\\" class=\\\"logo-out-container\\\">EVENTY.online</div><div hide-gt-md=\\\"\\\" class=\\\"upload-as-file\\\" device-detector=\\\"\\\"><button onclick=\\\"document.getElementById(\\'input-as-file\\').click()\\\">&nbsp;</button> <input type=\\\"file\\\" accept=\\\"video/*,image/*\\\" id=\\\"input-as-file\\\" multiple=\\\"\\\" name=\\\"files\\\" ng-disabled=\\\"progressCounter > 0\\\" onchange=\\\"angular.element(this).scope().HandleFiles(this.files)\\\"></div><h1 class=\\\"md-display-2 app-title\\\" hide-sm=\\\"\\\" hide-md=\\\"\\\"><b>EVENTY</b>.online<div class=\\\"app-subtitle\\\">Pošaljite <strong>jedinstvene trenutke</strong> koje ste vi zabilježli :)</div></h1><div layout=\\\"row\\\" layout-sm=\\\"column\\\" layout-md=\\\"column\\\" layout-fill=\\\"\\\" layout-align=\\\"space-around center\\\" layout-align-sm=\\\"start center\\\"><div hide-sm=\\\"\\\" hide-gt-md=\\\"\\\" class=\\\"logo-container\\\">EVENTY.online</div><div><h1 class=\\\"md-display-3\\\" hide-sm=\\\"\\\" hide-md=\\\"\\\"><span style=\\\"font-size: 36px;\\\">Pošaljite<br></span>Foto</h1><md-button class=\\\"md-fab\\\" aria-label=\\\"Fotoaparat\\\" onclick=\\\"document.getElementById(\\'input-photo\\').click()\\\"><md-icon md-svg-src=\\\"assets/svg/camera.svg\\\"></md-icon></md-button><input type=\\\"file\\\" accept=\\\"image/*\\\" id=\\\"input-photo\\\" capture=\\\"camera\\\" multiple=\\\"\\\" name=\\\"files\\\" ng-disabled=\\\"progressCounter > 0\\\" onchange=\\\"angular.element(this).scope().HandleFiles(this.files)\\\"></div><div hide-sm=\\\"\\\" hide-md=\\\"\\\" layout=\\\"row\\\"><h1 class=\\\"md-display-2\\\" style=\\\"margin: 20px; margin-right: 10px\\\">Gledajte <strong>LIVE</strong><br><md-button class=\\\"md-fab\\\" aria-label=\\\"Projektor\\\" ng-click=\\\"record.GoToWall()\\\"><md-icon md-svg-src=\\\"assets/svg/cinema.svg\\\"></md-icon></md-button></h1><h1 class=\\\"md-display-2\\\" style=\\\"margin: 20px; margin-left: 10px\\\">Otvorite <strong>GALERIJU</strong><br><md-button class=\\\"md-fab\\\" aria-label=\\\"Galerija\\\" ng-click=\\\"record.GoToGallery()\\\"><md-icon md-svg-src=\\\"assets/svg/gallery.svg\\\"></md-icon></md-button></h1></div><div><h1 class=\\\"md-display-3\\\" hide-sm=\\\"\\\" hide-md=\\\"\\\"><span style=\\\"font-size: 36px;\\\">Pošaljite<br></span>Video</h1><md-button class=\\\"md-fab\\\" hide-sm=\\\"\\\" hide-md=\\\"\\\" aria-label=\\\"Kamera\\\" onclick=\\\"document.getElementById(\\'input-video-multiple\\').click()\\\"><md-icon md-svg-src=\\\"assets/svg/camcorder.svg\\\"></md-icon></md-button><input type=\\\"file\\\" accept=\\\"video/*\\\" id=\\\"input-video-multiple\\\" capture=\\\"camcorder\\\" multiple=\\\"\\\" ng-disabled=\\\"progressCounter > 0\\\" name=\\\"files\\\" onchange=\\\"angular.element(this).scope().HandleFiles(this.files)\\\"><md-button class=\\\"md-fab\\\" hide-gt-md=\\\"\\\" aria-label=\\\"Kamera\\\" onclick=\\\"document.getElementById(\\'input-video\\').click()\\\"><md-icon md-svg-src=\\\"assets/svg/camcorder.svg\\\"></md-icon></md-button><input type=\\\"file\\\" accept=\\\"video/*\\\" id=\\\"input-video\\\" capture=\\\"camcorder\\\" name=\\\"files\\\" ng-disabled=\\\"progressCounter > 0\\\" onchange=\\\"angular.element(this).scope().HandleFiles(this.files)\\\"></div></div></div>\");\n$templateCache.put(\"app/wall/wall.html\",\"<div layout=\\\"column\\\" layout-fill=\\\"\\\" layout-align=\\\"space-around center\\\" layout-align-sm=\\\"start center\\\"><div id=\\\"wall\\\" ng-class=\\\"{ \\'slideshow\\': wall.slideshow, \\'verified\\': wall.wallMode === \\'verified\\', \\'watch\\': wall.wallMode === \\'watch\\' }\\\" flex=\\\"\\\"><div ng-if=\\\"!wall.files.length\\\" class=\\\"no-media-info\\\" style=\\\"height: {{windowInnerHeight}}px\\\" unselectable=\\\"on\\\"><img ng-if=\\\"wall.splash\\\" ng-src=\\\"{{wall.splash.url}}\\\"> <img ng-if=\\\"!wall.splash\\\" src=\\\"assets/images/splash.png\\\" style=\\\"max-height: {{windowInnerHeight * 0.7}}px; max-width: 100%; margin-top: {{windowInnerHeight * 0.15}}px\\\"></div><ul ng-show=\\\"wall.files.length\\\"><li ng-repeat=\\\"(key, file) in wall.files\\\" id=\\\"media-{{key}}\\\" ng-mousedown=\\\"wall.handleFile(file, $event)\\\" ng-class=\\\"{ \\'visible-animation\\': wall.flags.enableMainFileAnimation }\\\"><md-button ng-show=\\\"wall.isVerifyPage === true && key === 0\\\" class=\\\"md-fab verify\\\" ng-click=\\\"wall.verifyFile(file)\\\">&#10003;</md-button><md-button ng-show=\\\"wall.isVerifyPage === true && key === 0\\\" class=\\\"md-fab unverify\\\" ng-click=\\\"wall.unverifyFile(file)\\\">&#10007;</md-button><video class=\\\"box\\\" style=\\\"height: {{windowInnerHeight}}px\\\" ng-muted=\\\"{{key > 0}}\\\" ng-controls=\\\"{{!!file.controls}}\\\" autoplay=\\\"\\\" ng-show=\\\"key === 0 && file.type.startsWith(\\'video\\')\\\" ng-click=\\\"console.log(this)\\\"><source ng-src=\\\"{{file.trustedUrl}}\\\" type=\\\"video/mp4\\\"></video><div class=\\\"box\\\" style=\\\"height: 15vw\\\" ng-show=\\\"key > 0 && file.type.startsWith(\\'video\\')\\\"><video class=\\\"mosaic\\\" ng-muted=\\\"{{key > 0}}\\\" ng-controls=\\\"{{!!file.controls}}\\\" autoplay=\\\"\\\"><source ng-src=\\\"{{file.trustedUrl}}\\\" type=\\\"video/mp4\\\"></video></div><div class=\\\"box o{{file.orientation}}\\\" ng-dblclick=\\\"wall.removeFile(file)\\\" ng-show=\\\"key === 0 && file.type.startsWith(\\'image\\')\\\" style=\\\"height: {{windowInnerHeight}}px; width: {{firstImageWidth}}px; background-image: url(\\'{{file.url}}\\')\\\"></div><div class=\\\"box o{{file.orientation}} mosaic\\\" ng-show=\\\"key > 0 && file.type.startsWith(\\'image\\')\\\" style=\\\"height: {{(windowInnerWidth / 10) * 1.5}}px; background-image: url(\\'{{file.url}}\\')\\\"></div><div class=\\\"author\\\">{{file.url | filename}} {{file.removed | json}}</div></li></ul><div class=\\\"main-title\\\" ng-show=\\\"wall.files.length\\\"><img ng-if=\\\"wall.image\\\" ng-src=\\\"{{wall.image.url}}\\\"> <img ng-if=\\\"!wall.image\\\" src=\\\"assets/images/wall-image.png\\\"></div><div class=\\\"options\\\" ng-class=\\\"{ \\'is-visible-options\\' : isVisibleOptions }\\\" ng-mouseover=\\\"isVisibleOptions = true\\\" ng-mouseleave=\\\"isVisibleOptions = false\\\"><md-button class=\\\"md-fab\\\" aria-label=\\\"Projektor\\\" ng-click=\\\"wall.ToggleWallMode()\\\"><md-icon md-svg-src=\\\"assets/svg/cinema.svg\\\"></md-icon></md-button><md-button class=\\\"md-fab\\\" aria-label=\\\"Fotoaparat\\\" ng-click=\\\"wall.GoToRecord()\\\"><md-icon md-svg-src=\\\"assets/svg/camera.svg\\\"></md-icon></md-button><md-button class=\\\"md-fab\\\" aria-label=\\\"Fotoaparat\\\" ng-click=\\\"wall.GoToWallVerify()\\\" ng-if=\\\"wall.isVisibleWallVerifyOption\\\">ADMIN</md-button></div></div></div>\");}]);"],"sourceRoot":"/source/"}